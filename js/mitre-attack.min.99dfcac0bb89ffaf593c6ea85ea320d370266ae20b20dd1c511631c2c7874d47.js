let currentTab="enterprise",techniquesData={};function showTab(e){const n=document.querySelectorAll(".tab-content");n.forEach(e=>e.classList.remove("active"));const s=document.querySelectorAll(".tab-btn");s.forEach(e=>e.classList.remove("active"));const t=document.getElementById(e);t&&t.classList.add("active"),event&&event.target&&event.target.classList.add("active"),currentTab=e}function showTechniques(e){const t=getTechniquesForTactic(e);displayTechniques(t,e)}function getTechniquesForTactic(e){const t={reconnaissance:[{id:"T1595",name:"Active Scanning",description:"Scanning IP addresses, ports, and services"},{id:"T1592",name:"Gather Victim Host Information",description:"Collecting information about the target"},{id:"T1589",name:"Gather Victim Identity Information",description:"Collecting identity information"}],"initial-access":[{id:"T1078",name:"Valid Accounts",description:"Using existing accounts to gain access"},{id:"T1190",name:"Exploit Public-Facing Application",description:"Exploiting vulnerabilities in applications"},{id:"T1133",name:"External Remote Services",description:"Using external services for access"}],execution:[{id:"T1059",name:"Command and Scripting Interpreter",description:"Using command line interfaces"},{id:"T1053",name:"Scheduled Task/Job",description:"Using scheduled tasks for execution"},{id:"T1047",name:"Windows Management Instrumentation",description:"Using WMI for execution"}],persistence:[{id:"T1547",name:"Boot or Logon Autostart Execution",description:"Configuring autostart mechanisms"},{id:"T1053",name:"Scheduled Task/Job",description:"Creating scheduled tasks"},{id:"T1543",name:"Create or Modify System Process",description:"Creating system processes"}],"privilege-escalation":[{id:"T1548",name:"Abuse Elevation Control Mechanism",description:"Abusing elevation mechanisms"},{id:"T1134",name:"Access Token Manipulation",description:"Manipulating access tokens"},{id:"T1547",name:"Boot or Logon Autostart Execution",description:"Using autostart for escalation"}],"defense-evasion":[{id:"T1562",name:"Impair Defenses",description:"Disabling security controls"},{id:"T1070",name:"Indicator Removal on Host",description:"Removing evidence of compromise"},{id:"T1027",name:"Obfuscated Files or Information",description:"Hiding malicious files"}],"credential-access":[{id:"T1110",name:"Brute Force",description:"Attempting to guess passwords"},{id:"T1555",name:"Credentials from Password Stores",description:"Extracting stored credentials"},{id:"T1212",name:"Exploitation for Credential Access",description:"Exploiting systems for credentials"}],discovery:[{id:"T1083",name:"File and Directory Discovery",description:"Exploring file systems"},{id:"T1018",name:"Remote System Discovery",description:"Finding remote systems"},{id:"T1082",name:"System Information Discovery",description:"Gathering system information"}],"lateral-movement":[{id:"T1021",name:"Remote Services",description:"Using remote services for movement"},{id:"T1091",name:"Replication Through Removable Media",description:"Using removable media"},{id:"T1210",name:"Exploitation of Remote Services",description:"Exploiting remote services"}],collection:[{id:"T1056",name:"Input Capture",description:"Capturing user input"},{id:"T1113",name:"Screen Capture",description:"Taking screenshots"},{id:"T1114",name:"Email Collection",description:"Collecting email data"}],"command-and-control":[{id:"T1071",name:"Application Layer Protocol",description:"Using application protocols for C2"},{id:"T1095",name:"Non-Application Layer Protocol",description:"Using non-application protocols"},{id:"T1104",name:"Multi-Stage Channels",description:"Using multi-stage communication"}],exfiltration:[{id:"T1041",name:"Exfiltration Over C2 Channel",description:"Using C2 channels for exfiltration"},{id:"T1011",name:"Exfiltration Over Other Network Medium",description:"Using other network protocols"},{id:"T1052",name:"Exfiltration Over Physical Medium",description:"Using physical media"}],impact:[{id:"T1486",name:"Data Encrypted for Impact",description:"Encrypting data for ransom"},{id:"T1489",name:"Service Stop",description:"Stopping services"},{id:"T1565",name:"Data Manipulation",description:"Manipulating data integrity"}]};return t[e]||[]}function displayTechniques(e,t){const n=document.getElementById("techniquesList");if(!n)return;if(n.innerHTML="",e.length===0){n.innerHTML="<p>No techniques found for this tactic.</p>";return}const s=document.createElement("h3");s.textContent=`${t.charAt(0).toUpperCase()+t.slice(1).replace("-"," ")} Techniques`,n.appendChild(s),e.forEach(e=>{const t=document.createElement("div");t.className="technique-item",t.innerHTML=`
      <h4>${e.id} - ${e.name}</h4>
      <p>${e.description}</p>
      <div class="technique-actions">
        <button onclick="showTechniqueDetails('${e.id}')">Details</button>
        <button onclick="addToFavorites('${e.id}')">Favorite</button>
      </div>
    `,n.appendChild(t)})}function searchTechniques(){const t=document.getElementById("techniqueSearch");if(!t)return;const e=t.value.toLowerCase(),n=getAllTechniques(),s=n.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.id.toLowerCase().includes(e));displaySearchResults(s)}function getAllTechniques(){const e=[],t=["reconnaissance","initial-access","execution","persistence","privilege-escalation","defense-evasion","credential-access","discovery","lateral-movement","collection","command-and-control","exfiltration","impact"];return t.forEach(t=>{const n=getTechniquesForTactic(t);n.forEach(n=>{n.tactic=t,e.push(n)})}),e}function displaySearchResults(e){const t=document.getElementById("techniquesList");if(!t)return;if(t.innerHTML="",e.length===0){t.innerHTML="<p>No techniques found matching your search.</p>";return}const n=document.createElement("h3");n.textContent=`Search Results (${e.length} techniques)`,t.appendChild(n),e.forEach(e=>{const n=document.createElement("div");n.className="technique-item",n.innerHTML=`
      <h4>${e.id} - ${e.name}</h4>
      <p>${e.description}</p>
      <span class="tactic-tag">${e.tactic}</span>
      <div class="technique-actions">
        <button onclick="showTechniqueDetails('${e.id}')">Details</button>
        <button onclick="addToFavorites('${e.id}')">Favorite</button>
      </div>
    `,t.appendChild(n)})}function filterByTactic(){const t=document.getElementById("tacticFilter");if(!t)return;const e=t.value;if(e){const t=getTechniquesForTactic(e);displayTechniques(t,e)}else{const e=document.getElementById("techniquesList");e&&(e.innerHTML="<p>Select a tactic to view techniques.</p>")}}function showTechniqueDetails(e){alert(`Detailed information for ${e} would be displayed here. This could include:

- Detailed description
- Examples of use
- Detection methods
- Mitigation strategies
- Related techniques
- Threat groups that use this technique`)}function addToFavorites(e){const t=JSON.parse(localStorage.getItem("mitreFavorites")||"[]");t.includes(e)?alert(`${e} is already in your favorites.`):(t.push(e),localStorage.setItem("mitreFavorites",JSON.stringify(t)),alert(`${e} added to favorites!`))}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("techniquesList");e&&(e.innerHTML="<p>Select a tactic from the matrix above to view techniques.</p>");const t=document.querySelectorAll(".tactic-card");t.forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="scale(1.05)"}),e.addEventListener("mouseleave",function(){this.style.transform="scale(1)"})});const n=document.querySelectorAll(".tab-btn");n.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("onclick")?.match(/showTab\('([^']+)'\)/)?.[1];e&&showTab(e)})}),t.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("onclick")?.match(/showTechniques\('([^']+)'\)/)?.[1];e&&showTechniques(e)})})})