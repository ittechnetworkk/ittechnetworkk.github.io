const ouiDatabase={"00:1B:44":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:50:56":{vendor:"VMware, Inc.",address:"Palo Alto, CA, USA"},"08:00:27":{vendor:"Oracle Corporation",address:"Redwood City, CA, USA"},"00:0C:29":{vendor:"VMware, Inc.",address:"Palo Alto, CA, USA"},"00:16:3E":{vendor:"Citrix Systems, Inc.",address:"Fort Lauderdale, FL, USA"},"52:54:00":{vendor:"QEMU/KVM Virtual Machine",address:"Virtual Environment"},"AC:DE:48":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:1A:A2":{vendor:"Asix Electronics Corporation",address:"Taiwan"},"00:E0:4C":{vendor:"Realtek Semiconductor Corp.",address:"Taiwan"},"00:90:F5":{vendor:"Cisco Systems, Inc.",address:"San Jose, CA, USA"},"00:26:BB":{vendor:"Cisco Systems, Inc.",address:"San Jose, CA, USA"},"74:DA:38":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:15:5D":{vendor:"Microsoft Corporation",address:"Redmond, WA, USA"},"00:03:FF":{vendor:"Microsoft Corporation",address:"Redmond, WA, USA"},"2C:F0:5D":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"68:05:CA":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:1C:42":{vendor:"Parallels, Inc.",address:"Bellevue, WA, USA"}};function performMACLookup(){const t=document.getElementById("macAddress").value.trim();if(!t){showMACError("Please enter a MAC address");return}const e=validateAndNormalizeMAC(t);if(!e){showMACError("Please enter a valid MAC address (e.g., 00:1B:44:11:3A:B7)");return}showMACLoading(),hideMACResults(),hideMACError(),setTimeout(()=>{try{const n=analyzeMACAddress(e);displayMACResults(t,e,n),updateMACConverter(e)}catch(e){showMACError("Failed to analyze MAC address: "+e.message)}finally{hideMACLoading()}},800+Math.random()*1200)}function validateAndNormalizeMAC(e){const t=e.replace(/[:-.\s]/g,"").toUpperCase();return/^[0-9A-F]{12}$/.test(t)?t.match(/.{2}/g).join(":"):null}function analyzeMACAddress(e){const i=e.split(":"),t=i.slice(0,3).join(":"),a=parseInt(i[0],16),n=(a&1)===1,s=(a&2)===2,o=ouiDatabase[t]||lookupVendorFallback(t);return{oui:t,vendor:o.vendor,vendorAddress:o.address,isMulticast:n,isLocallyAdministered:s,addressType:n?"Multicast":"Unicast",transmissionType:s?"Locally Administered":"Globally Unique",additionalInfo:generateAdditionalInfo(o,n,s)}}function lookupVendorFallback(e){const t=e.substring(0,5),n={"00:1B":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:50":{vendor:"VMware, Inc.",address:"Palo Alto, CA, USA"},"08:00":{vendor:"Oracle/VirtualBox",address:"Virtual Environment"},"00:0C":{vendor:"VMware, Inc.",address:"Palo Alto, CA, USA"},"00:90":{vendor:"Cisco Systems",address:"San Jose, CA, USA"},"00:26":{vendor:"Cisco Systems",address:"San Jose, CA, USA"},"74:DA":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"00:15":{vendor:"Microsoft Corporation",address:"Redmond, WA, USA"},"2C:F0":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"},"68:05":{vendor:"Apple, Inc.",address:"Cupertino, CA, USA"}};return n[t]||{vendor:"Unknown Vendor",address:"Vendor information not available in database"}}function generateAdditionalInfo(e,t,n){let s=[];return e.vendor.includes("Apple")?s.push("This MAC address belongs to an Apple device (iPhone, iPad, Mac, etc.)"):e.vendor.includes("VMware")||e.vendor.includes("Oracle")||e.vendor.includes("Virtual")?s.push("This appears to be a virtual machine network adapter"):e.vendor.includes("Cisco")?s.push("This MAC address belongs to Cisco networking equipment"):e.vendor.includes("Microsoft")&&s.push("This MAC address belongs to Microsoft hardware or software"),t&&s.push("Multicast addresses are used for group communication"),n?s.push("Locally administered addresses are assigned by network administrators"):s.push("This is a globally unique address assigned by the manufacturer"),s.join(". ")}function displayMACResults(e,t,n){document.getElementById("originalMAC").textContent=e,document.getElementById("formattedMAC").textContent=t,document.getElementById("ouiValue").textContent=n.oui,document.getElementById("vendorName").textContent=n.vendor,document.getElementById("vendorAddress").textContent=n.vendorAddress;const s=document.getElementById("addressType"),o=document.getElementById("transmissionType");s.innerHTML=createStatusIndicator(n.addressType,n.isMulticast?"status-multicast":"status-unicast"),o.innerHTML=createStatusIndicator(n.transmissionType,n.isLocallyAdministered?"status-local":"status-global"),document.getElementById("additionalDetails").textContent=n.additionalInfo,document.getElementById("macResults").style.display="block"}function createStatusIndicator(e,t){return`<span class="status-indicator ${t}">${e}</span>`}function updateMACConverter(e){const t=e.split(":");document.getElementById("colonFormat").value=e,document.getElementById("hyphenFormat").value=e.replace(/:/g,"-"),document.getElementById("dotFormat").value=`${t[0]}${t[1]}.${t[2]}${t[3]}.${t[4]}${t[5]}`,document.getElementById("noSeparators").value=e.replace(/:/g,"")}function generateRandomMAC(){const e=Object.keys(ouiDatabase),n=e[Math.floor(Math.random()*e.length)],t=[];for(let e=0;e<3;e++)t.push(Math.floor(Math.random()*256).toString(16).padStart(2,"0").toUpperCase());const s=n+":"+t.join(":");document.getElementById("macAddress").value=s,performMACLookup()}function clearMACResults(){hideMACResults(),hideMACError(),hideMACLoading(),document.getElementById("macAddress").value="",document.getElementById("colonFormat").value="",document.getElementById("hyphenFormat").value="",document.getElementById("dotFormat").value="",document.getElementById("noSeparators").value=""}function showMACLoading(){document.getElementById("macLoading").style.display="flex"}function hideMACLoading(){document.getElementById("macLoading").style.display="none"}function showMACResults(){document.getElementById("macResults").style.display="block"}function hideMACResults(){document.getElementById("macResults").style.display="none"}function showMACError(e){const t=document.getElementById("macError"),n=document.getElementById("macErrorText");n.textContent=e,t.style.display="flex"}function hideMACError(){document.getElementById("macError").style.display="none"}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("macAddress");e&&(e.addEventListener("keypress",function(e){e.key==="Enter"&&performMACLookup()}),e.addEventListener("input",function(e){let t=e.target.value.replace(/[^0-9A-Fa-f]/g,"");t.length>12&&(t=t.substring(0,12)),t.length>2&&(t=t.match(/.{1,2}/g).join(":")),e.target.value=t.toUpperCase()}));const t=document.querySelectorAll(".converter-item input");t.forEach(e=>{e.addEventListener("click",function(){this.select()})})})