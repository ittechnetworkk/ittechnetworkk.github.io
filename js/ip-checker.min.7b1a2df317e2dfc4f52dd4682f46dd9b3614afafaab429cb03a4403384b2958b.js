const COMMON_PORTS=[21,22,23,25,53,80,110,143,443,465,587,993,995,3306,3389,5432,8080];async function getIPInfo(){try{const t=document.querySelectorAll(".loading");t.forEach(e=>e.classList.add("loading"));const n=await fetch("https://ipinfo.io/json"),e=await n.json();if(e&&e.ip){try{const t=await fetch("https://api64.ipify.org?format=json"),n=await t.json(),s=document.getElementById("ip-address");s.innerHTML=`
                    <div>IPv4: ${e.ip}</div>
                    <div>IPv6: ${n.ip||"Not available"}</div>
                `}catch{const t=document.getElementById("ip-address");t.innerHTML=`
                    <div>IPv4: ${e.ip}</div>
                    <div>IPv6: Not available</div>
                `}const n=document.getElementById("type");n.style.display="none";const t=document.getElementById("country-flag");t.src=`https://flagcdn.com/w160/${e.country.toLowerCase()}.png`,t.alt=`${e.country} flag`;const[s,o]=(e.loc||"").split(",");document.getElementById("country").textContent=e.country,document.getElementById("region").textContent=e.region,document.getElementById("city").textContent=e.city,document.getElementById("location").textContent=`${e.city}, ${e.country}`,document.getElementById("isp").textContent=e.org||"Not available",document.getElementById("timezone").textContent=e.timezone,document.getElementById("coordinates").textContent=e.loc||"Not available",document.getElementById("postal").textContent=e.postal||"Not available";try{const n=await fetch(`https://restcountries.com/v3.1/alpha/${e.country}`),t=await n.json();if(t&&t[0]&&t[0].currencies){const e=Object.keys(t[0].currencies)[0],n=t[0].currencies[e].name,s=t[0].currencies[e].symbol;document.getElementById("currency").textContent=`${n} (${s})`}else document.getElementById("currency").textContent="Not available"}catch(e){console.error("Error fetching currency info:",e),document.getElementById("currency").textContent="Not available"}}else setErrorState();t.forEach(e=>e.classList.remove("loading"))}catch(e){console.error("Error fetching IP info:",e),setErrorState()}}function updateIPDisplay(e){const t=document.getElementById("ip-address"),n=document.getElementById("type");t.textContent=e,n.textContent=e.includes(":")?"IPv6":"IPv4"}function updateLocationInfo(e){const t=document.getElementById("country-flag");t.src=`https://flagcdn.com/w160/${e.country_code.toLowerCase()}.png`,t.alt=`${e.country_name} flag`,document.getElementById("country").textContent=e.country_name,document.getElementById("region").textContent=e.region,document.getElementById("city").textContent=e.city,document.getElementById("location").textContent=`${e.city}, ${e.country_name}`,document.getElementById("isp").textContent=e.org}function updateExtendedInfo(e){document.getElementById("timezone").textContent=e.timezone,document.getElementById("coordinates").textContent=`${e.latitude}, ${e.longitude}`,document.getElementById("postal").textContent=e.postal||"Not available",document.getElementById("currency").textContent=e.currency||"Not available"}async function getNetworkDetails(){try{const e=await fetch("https://cloudflare-dns.com/dns-query",{headers:{Accept:"application/dns-json"}}),t=await e.json();return{subnetMask:"255.255.255.0",gateway:"Requires local network access",dnsServers:["1.1.1.1","8.8.8.8"]}}catch(e){return console.error("Error fetching network details:",e),{subnetMask:"Not available",gateway:"Not available",dnsServers:[]}}}async function pingHost(e){const t=document.getElementById("ping-result");t.textContent="Pinging...",t.className="result-box";try{const n=performance.now();await fetch(`https://${e}`,{mode:"no-cors"});const s=performance.now(),o=Math.round(s-n);t.textContent=`Host is reachable
Response time: ${o}ms`,t.className="result-box success"}catch{t.textContent="Host unreachable or error occurred",t.className="result-box error"}}async function dnsLookup(e){const t=document.getElementById("dns-result");t.textContent="Looking up DNS records...",t.className="result-box";try{const s=await fetch(`https://dns.google/resolve?name=${e}`),n=await s.json();if(n.Answer){const e=n.Answer.map(e=>`${e.name} (${e.type}): ${e.data}`).join(`
`);t.textContent=e,t.className="result-box success"}else t.textContent="No DNS records found",t.className="result-box error"}catch{t.textContent="Error looking up DNS records",t.className="result-box error"}}async function checkHeaders(e){const t=document.getElementById("headers-result");t.textContent="Checking headers...",t.className="result-box";try{const n=await fetch(e,{method:"HEAD"}),s=Array.from(n.headers.entries()).map(([e,t])=>`${e}: ${t}`).join(`
`);t.textContent=s||"No headers found",t.className="result-box success"}catch{t.textContent="Error checking headers",t.className="result-box error"}}function setErrorState(){const t=["ip-address","location","isp","country","region","city","timezone","coordinates","postal","currency"];t.forEach(e=>{const t=document.getElementById(e);t&&(e==="ip-address"?t.innerHTML=`
                    <div>IPv4: Not available</div>
                    <div>IPv6: Not available</div>
                `:t.textContent="Not available",t.classList.remove("loading"))});const e=document.getElementById("country-flag");e.src="",e.alt="Flag not available"}function copyToClipboard(e){if(e.includes("<div>")){const t=document.createElement("div");t.innerHTML=e,e=Array.from(t.childNodes).map(e=>e.textContent.trim()).join(`
`)}navigator.clipboard.writeText(e).then(()=>{const e=document.createElement("div");e.className="copy-notification",e.textContent="Copied!",document.body.appendChild(e),setTimeout(()=>{e.remove()},2e3)}).catch(e=>{console.error("Failed to copy:",e)})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("refresh-ip");e.addEventListener("click",getIPInfo),document.querySelectorAll(".copy-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.copy,n=document.getElementById(t).textContent;copyToClipboard(n)})});const t=document.getElementById("start-ping");t.addEventListener("click",()=>{const e=document.getElementById("ping-host").value.trim();e&&pingHost(e)});const n=document.getElementById("start-dns");n.addEventListener("click",()=>{const e=document.getElementById("dns-host").value.trim();e&&dnsLookup(e)});const s=document.getElementById("check-headers");s.addEventListener("click",()=>{const e=document.getElementById("headers-url").value.trim();e&&checkHeaders(e)}),setTimeout(getIPInfo,100)}),window.addEventListener("load",getIPInfo)