<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>[EN] Understanding YARA Rules | ittechnetworkk</title><link rel=canonical href=https://ittechnetworkk.github.io/posts/yararules/yararules/><meta name=description content="Hi, I'm Soner, and this is my personal blog where I share insights, guides, and articles on various tech topics, including Networking, Linux, Windows, Virtualization, Firewalls, IoT, and more. I'm constantly learning and exploring new technologies, and this blog is where I document my journey. "><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://ittechnetworkk.github.io/posts/yararules/yararules/"><meta property="og:site_name" content="ittechnetworkk"><meta property="og:title" content="[EN] Understanding YARA Rules"><meta property="og:description" content="Hi everyone! In this article, I’d like to introduce you to YARA rules, which are powerful detection rules widely used in cybersecurity to identify malware and other suspicious patterns.
What are YARA Rules? YARA rules are pattern-matching rules that help security professionals detect specific characteristics in files, such as malware signatures, suspicious strings, or other indicators of compromise. They’re essential tools in the cybersecurity analyst’s toolkit.
Basic YARA Rule Structure The best way to learn YARA rules is by examining examples. Let’s start with the fundamental structure:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-31T04:14:34+02:00"><meta property="article:modified_time" content="2025-08-31T04:14:34+02:00"><meta property="article:tag" content="Yara"><meta property="article:tag" content="Detection"><meta property="article:tag" content="Soc"><meta name=twitter:card content="summary"><meta name=twitter:title content="[EN] Understanding YARA Rules"><meta name=twitter:description content="Hi everyone! In this article, I’d like to introduce you to YARA rules, which are powerful detection rules widely used in cybersecurity to identify malware and other suspicious patterns.
What are YARA Rules? YARA rules are pattern-matching rules that help security professionals detect specific characteristics in files, such as malware signatures, suspicious strings, or other indicators of compromise. They’re essential tools in the cybersecurity analyst’s toolkit.
Basic YARA Rule Structure The best way to learn YARA rules is by examining examples. Let’s start with the fundamental structure:"><link rel=stylesheet href=https://ittechnetworkk.github.io/css/styles.bdd621ce0dc4beed42cba9d295fbb7a846b8870c3fda65b870471926d718c2543ebb5d8d248ba9a5554cba6ec2e05b0dc829190fd4e4fef576beaa4c3f244abe.css integrity="sha512-vdYhzg3Evu1Cy6nSlfu3qEa4hww/2mW4cEcZJtcYwlQ+u12NJIuppVVMum7C4FsNyCkZD9Tk/vV2vqpMPyRKvg=="><link rel=stylesheet href=https://ittechnetworkk.github.io/css/custom.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/lightbox.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/tools.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/tools-cards.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/post-cards.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/posts-cards.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ittechnetworkk.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://ittechnetworkk.github.io/posts/windowslogontypes/windowslogontypes/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&text=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&is_video=false&description=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Understanding%20YARA%20Rules&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&name=%5bEN%5d%20Understanding%20YARA%20Rules&description=%3cp%3eHi%20everyone%21%20In%20this%20article%2c%20I%26rsquo%3bd%20like%20to%20introduce%20you%20to%20YARA%20rules%2c%20which%20are%20powerful%20detection%20rules%20widely%20used%20in%20cybersecurity%20to%20identify%20malware%20and%20other%20suspicious%20patterns.%3c%2fp%3e%0a%3ch2%20id%3d%22what-are-yara-rules%22%3eWhat%20are%20YARA%20Rules%3f%3c%2fh2%3e%0a%3cp%3eYARA%20rules%20are%20pattern-matching%20rules%20that%20help%20security%20professionals%20detect%20specific%20characteristics%20in%20files%2c%20such%20as%20malware%20signatures%2c%20suspicious%20strings%2c%20or%20other%20indicators%20of%20compromise.%20They%26rsquo%3bre%20essential%20tools%20in%20the%20cybersecurity%20analyst%26rsquo%3bs%20toolkit.%3c%2fp%3e%0a%3ch2%20id%3d%22basic-yara-rule-structure%22%3eBasic%20YARA%20Rule%20Structure%3c%2fh2%3e%0a%3cp%3eThe%20best%20way%20to%20learn%20YARA%20rules%20is%20by%20examining%20examples.%20Let%26rsquo%3bs%20start%20with%20the%20fundamental%20structure%3a%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&t=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#what-are-yara-rules>What are YARA Rules?</a></li><li><a href=#basic-yara-rule-structure>Basic YARA Rule Structure</a><ul><li><a href=#how-it-works>How It Works?</a></li></ul></li><li><a href=#practical-example>Practical Example</a></li><li><a href=#case-sensitivity>Case Sensitivity</a></li><li><a href=#advanced-string-matching>Advanced String Matching</a></li><li><a href=#regular-expressions-and-more>Regular Expressions and More</a></li><li><a href=#key-yara-keywords>Key YARA Keywords</a></li><li><a href=#real-world-examples>Real-World Examples</a><ul><li><a href=#example-1-ransomware-detection>Example 1: Ransomware Detection</a></li><li><a href=#example-2-cobalt-strike-beacon-detection>Example 2: Cobalt Strike Beacon Detection</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">[EN] Understanding YARA Rules</h1><div class=meta><div class=author-info style=font-size:1.1em;margin-bottom:10px><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><strong>Author:</strong> <span itemprop=name>Soner Sahin</span></span></div><div class=postdate><time datetime="2025-08-31 04:14:34 +0200 CEST" itemprop=datePublished>2025-08-31</time></div><div class=article-read-time><i class="far fa-clock"></i>
6 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/soc>SOC</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/yara rel=tag>yara</a>
,
<a class=tag-link href=/tags/detection rel=tag>detection</a>
,
<a class=tag-link href=/tags/soc rel=tag>soc</a></div></div></header><div class=content itemprop=articleBody><p>Hi everyone! In this article, I&rsquo;d like to introduce you to YARA rules, which are powerful detection rules widely used in cybersecurity to identify malware and other suspicious patterns.</p><h2 id=what-are-yara-rules>What are YARA Rules?</h2><p>YARA rules are pattern-matching rules that help security professionals detect specific characteristics in files, such as malware signatures, suspicious strings, or other indicators of compromise. They&rsquo;re essential tools in the cybersecurity analyst&rsquo;s toolkit.</p><h2 id=basic-yara-rule-structure>Basic YARA Rule Structure</h2><p>The best way to learn YARA rules is by examining examples. Let&rsquo;s start with the fundamental structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>rule MyRule
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;malware&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><h3 id=how-it-works>How It Works?</h3><ul><li><strong>Rule Name</strong>: The first line defines the rule name (in this case, &ldquo;MyRule&rdquo;)</li><li><strong>Strings Section</strong>: Under the &ldquo;strings&rdquo; heading, we define the patterns we want to detect. You can specify multiple strings, one after another</li><li><strong>Condition Section</strong>: Here we specify when the rule should trigger - in this case, if any of the defined strings are found</li></ul><h2 id=practical-example>Practical Example</h2><p>Let me demonstrate by creating a YARA file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ nano malware.yar
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>rule MyRule
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;malware&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>I&rsquo;ll create three test files to demonstrate the detection:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ <span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;test check cyber&#34;</span> &gt; file1.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ <span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;Dublin Malware emoTeT&#34;</span> &gt; file2.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ <span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#f1fa8c>&#34;Tokyo malicious malware&#34;</span> &gt; file3.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ cat file1.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#8be9fd;font-style:italic>test</span> check cyber
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ cat file2.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>Dublin Malware emoTeT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ cat file3.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>Tokyo malicious malware
</span></span></code></pre></div><p><img src=/images/yararules/1.png alt=yara></p><p>Let&rsquo;s check our directory structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ ll
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>total <span style=color:#bd93f9>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>-rw-r--r--. <span style=color:#bd93f9>1</span> ssnrshnn ssnrshnn <span style=color:#bd93f9>17</span> Aug <span style=color:#bd93f9>25</span> 23:58 file1.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>-rw-r--r--. <span style=color:#bd93f9>1</span> ssnrshnn ssnrshnn <span style=color:#bd93f9>22</span> Aug <span style=color:#bd93f9>25</span> 23:58 file2.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>-rw-r--r--. <span style=color:#bd93f9>1</span> ssnrshnn ssnrshnn <span style=color:#bd93f9>24</span> Aug <span style=color:#bd93f9>25</span> 23:59 file3.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>-rw-r--r--. <span style=color:#bd93f9>1</span> ssnrshnn ssnrshnn <span style=color:#bd93f9>93</span> Aug <span style=color:#bd93f9>26</span> 00:02 malware.yar
</span></span></code></pre></div><p><img src=/images/yararules/2.png alt=yara></p><p>Now let&rsquo;s test our YARA rule against each file to detect which ones contain the &ldquo;malware&rdquo; string:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ yara malware.yar file1.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ yara malware.yar file2.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>ssnrshnn@ittechnetworkk:~/yara_rules$ yara malware.yar file3.txt 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>MyRule file3.txt
</span></span></code></pre></div><p><img src=/images/yararules/3.png alt=yara></p><p>Perfect! As you can see, the rule was triggered and we found the matching string in &ldquo;file3.txt&rdquo;.</p><h2 id=case-sensitivity>Case Sensitivity</h2><p><strong>Important Note</strong>: YARA rules are case-sensitive by default. Notice that &ldquo;file2.txt&rdquo; contains &ldquo;Malware&rdquo; (with a capital M), but our rule didn&rsquo;t trigger because it was looking for &ldquo;malware&rdquo; (lowercase).</p><p>To make the rule case-insensitive, add the <code>nocase</code> modifier:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>rule MyRule
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;malware&#34;</span> nocase
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>        <span style=color:#8be9fd;font-style:italic>$text</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>Let&rsquo;s test the case-insensitive version:</p><p><img src=/images/yararules/4.png alt=yara></p><p>Excellent! Now the rule detects both &ldquo;malware&rdquo; and &ldquo;Malware&rdquo;.</p><h2 id=advanced-string-matching>Advanced String Matching</h2><p>We can create more sophisticated rules by combining multiple strings and using different matching techniques:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>rule MyRule
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>        <span style=color:#8be9fd;font-style:italic>$string1</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;london&#34;</span> nocase
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>        <span style=color:#8be9fd;font-style:italic>$string2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;test&#34;</span> nocase
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>        <span style=color:#8be9fd;font-style:italic>$hex1</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span> 6D <span style=color:#bd93f9>61</span> 6C <span style=color:#bd93f9>77</span> <span style=color:#bd93f9>61</span> <span style=color:#bd93f9>72</span> <span style=color:#bd93f9>65</span> <span style=color:#ff79c6>}</span>     // Hex representation of <span style=color:#f1fa8c>&#34;malware&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#8be9fd;font-style:italic>$string1</span> or <span style=color:#8be9fd;font-style:italic>$string2</span> or <span style=color:#8be9fd;font-style:italic>$hex1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>In this example, I&rsquo;ve added three different types of strings:</p><ul><li><strong>Text strings</strong>: &ldquo;london&rdquo; and &ldquo;test&rdquo; (case-insensitive)</li><li><strong>Hexadecimal strings</strong>: The hex representation of &ldquo;malware&rdquo;</li><li><strong>Logical operators</strong>: The &ldquo;or&rdquo; condition means the rule triggers if ANY of these strings are found</li></ul><p><img src=/images/yararules/5.png alt=yara></p><h2 id=regular-expressions-and-more>Regular Expressions and More</h2><p>Here&rsquo;s another example demonstrating regular expressions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>rule MyRule
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>        <span style=color:#8be9fd;font-style:italic>$string1</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;london&#34;</span> nocase
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>        <span style=color:#8be9fd;font-style:italic>$hex1</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span> <span style=color:#bd93f9>65</span> 6D 6F <span style=color:#bd93f9>54</span> <span style=color:#bd93f9>65</span> <span style=color:#bd93f9>54</span> <span style=color:#ff79c6>}</span>    // Hex representation of <span style=color:#f1fa8c>&#34;emoTeT&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>        <span style=color:#8be9fd;font-style:italic>$regex1</span> <span style=color:#ff79c6>=</span> /malicious/i
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#8be9fd;font-style:italic>$string1</span> or <span style=color:#8be9fd;font-style:italic>$hex1</span> or <span style=color:#8be9fd;font-style:italic>$regex1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p><img src=/images/yararules/6.png alt=yara></p><h2 id=key-yara-keywords>Key YARA Keywords</h2><p>Here are some essential keywords that will be useful for writing rules:</p><table><thead><tr><th>all</th><th>and</th><th>any</th><th>ascii</th><th>at</th><th>base64</th><th>base64wide</th><th>condition</th></tr></thead><tbody><tr><td>contains</td><td>endswith</td><td>entrypoint</td><td>false</td><td>filesize</td><td>for</td><td>fullword</td><td>global</td></tr><tr><td>import</td><td>icontains</td><td>iendswith</td><td>iequals</td><td>in</td><td>include</td><td>int16</td><td>int16be</td></tr><tr><td>int32</td><td>int32be</td><td>int8</td><td>int8be</td><td>istartswith</td><td>matches</td><td>meta</td><td>nocase</td></tr><tr><td>none</td><td>not</td><td>of</td><td>or</td><td>private</td><td>rule</td><td>startswith</td><td>strings</td></tr><tr><td>them</td><td>true</td><td>uint16</td><td>uint16be</td><td>uint32</td><td>uint32be</td><td>uint8</td><td>uint8be</td></tr><tr><td>wide</td><td>xor</td><td>defined</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>For comprehensive documentation, visit the <a href=https://yara.readthedocs.io/en/stable/writingrules.html>official YARA documentation</a>.</p><h2 id=real-world-examples>Real-World Examples</h2><p>Now let&rsquo;s examine some advanced rules used in actual cybersecurity scenarios.</p><p><a href=https://github.com/Yara-Rules/rules>Here</a> you can find various rules for both learning and practical use.</p><h3 id=example-1-ransomware-detection>Example 1: Ransomware Detection</h3><p><a href=https://github.com/Yara-Rules/rules/blob/master/malware/RANSOM_DoublePulsar_Petya.yar>RANSOM_DoublePulsar_Petya.yar</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>rule DoublePulsarXor_Petya
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> meta:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>   <span style=color:#8be9fd;font-style:italic>description</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Rule to hit on the XORed DoublePulsar shellcode&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>   <span style=color:#8be9fd;font-style:italic>author</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Patrick Jones&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>   <span style=color:#8be9fd;font-style:italic>company</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Booz Allen Hamilton&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>   <span style=color:#8be9fd;font-style:italic>reference1</span> <span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>   <span style=color:#8be9fd;font-style:italic>reference2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>   <span style=color:#8be9fd;font-style:italic>date</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;2017-06-28&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>   <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>   <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span> strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>   <span style=color:#8be9fd;font-style:italic>$DoublePulsarXor_Petya</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span> FD 0C 8C 5C B8 C4 <span style=color:#bd93f9>24</span> C5 CC CC CC 0E E8 CC <span style=color:#bd93f9>24</span> 6B CC CC CC 0F <span style=color:#bd93f9>24</span> CD CC CC CC <span style=color:#bd93f9>27</span> 5C <span style=color:#bd93f9>97</span> <span style=color:#bd93f9>75</span> BA CD CC CC C3 FE <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span> condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>   <span style=color:#8be9fd;font-style:italic>$DoublePulsarXor_Petya</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>rule DoublePulsarDllInjection_Petya
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span> meta:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>  <span style=color:#8be9fd;font-style:italic>description</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Rule to hit on the XORed DoublePulsar DLL injection shellcode&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>  <span style=color:#8be9fd;font-style:italic>author</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Patrick Jones&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  <span style=color:#8be9fd;font-style:italic>company</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Booz Allen Hamilton&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  <span style=color:#8be9fd;font-style:italic>reference1</span> <span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>  <span style=color:#8be9fd;font-style:italic>reference2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>  <span style=color:#8be9fd;font-style:italic>date</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;2017-06-28&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>  <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>  <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1&#34;</span> 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span> strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>   <span style=color:#8be9fd;font-style:italic>$DoublePulsarDllInjection_Petya</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>20</span> 8D <span style=color:#bd93f9>93</span> 8D <span style=color:#bd93f9>92</span> 8D <span style=color:#bd93f9>91</span> 8D <span style=color:#bd93f9>90</span> <span style=color:#bd93f9>92</span> <span style=color:#bd93f9>93</span> <span style=color:#bd93f9>91</span> <span style=color:#bd93f9>97</span> 0F 9F 9E 9D <span style=color:#bd93f9>99</span> <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>29</span> <span style=color:#bd93f9>84</span> 4D <span style=color:#bd93f9>20</span> CC CD CC CC 9B <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>03</span> <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>14</span> <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>49</span> CC <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>24</span> <span style=color:#bd93f9>77</span> CC CC CC <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>49</span> C4 <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>24</span> <span style=color:#bd93f9>84</span> CD CC CC <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>49</span> DC <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>47</span> <span style=color:#bd93f9>49</span> CC <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>84</span> <span style=color:#bd93f9>47</span> <span style=color:#bd93f9>41</span> <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span> condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>   <span style=color:#8be9fd;font-style:italic>$DoublePulsarDllInjection_Petya</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#ff79c6>}</span> 
</span></span></code></pre></div><p>Notice the <strong>meta</strong> section, which allows you to provide additional information about the rule, including:</p><ul><li>Description</li><li>Author details</li><li>Company information</li><li>References</li><li>Date</li><li>File hashes</li></ul><p>The <strong>strings</strong> section contains hexadecimal patterns that uniquely identify the malware, making detection possible.</p><h3 id=example-2-cobalt-strike-beacon-detection>Example 2: Cobalt Strike Beacon Detection</h3><p><a href=https://github.com/kevoreilly/CAPEv2/blob/master/data/yara/CAPE/CobaltStrikeBeacon.yar>CobaltStrikeBeacon.yar</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>rule CobaltStrikeBeacon
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    meta:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>        <span style=color:#8be9fd;font-style:italic>author</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;ditekshen, enzo &amp; Elastic&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>        <span style=color:#8be9fd;font-style:italic>description</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Cobalt Strike Beacon Payload&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>        <span style=color:#8be9fd;font-style:italic>cape_type</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;CobaltStrikeBeacon Payload&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    strings:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>        <span style=color:#8be9fd;font-style:italic>$s1</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;%%IMPORT%%&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#8be9fd;font-style:italic>$s2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;www6.%x%x.%s&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>        <span style=color:#8be9fd;font-style:italic>$s3</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;cdn.%x%x.%s&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        <span style=color:#8be9fd;font-style:italic>$s4</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;api.%x%x.%s&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>        <span style=color:#8be9fd;font-style:italic>$s5</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;%s (admin)&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        <span style=color:#8be9fd;font-style:italic>$s6</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;could not spawn %s: %d&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>        <span style=color:#8be9fd;font-style:italic>$s7</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Could not kill %d: %d&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>        <span style=color:#8be9fd;font-style:italic>$s8</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Could not connect to pipe (%s): %d&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>        <span style=color:#8be9fd;font-style:italic>$s9</span> <span style=color:#ff79c6>=</span> /%s<span style=color:#f1fa8c>\.\d</span><span style=color:#ff79c6>[(</span>%08x<span style=color:#ff79c6>)</span>.<span style=color:#ff79c6>]</span>+<span style=color:#f1fa8c>\.</span>%x%x<span style=color:#f1fa8c>\.</span>%s/ ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        <span style=color:#8be9fd;font-style:italic>$pwsh1</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;IEX (New-Object Net.Webclient).DownloadString(&#39;http&#34;</span> ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>        <span style=color:#8be9fd;font-style:italic>$pwsh2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;powershell -nop -exec bypass -EncodedCommand \&#34;%s\&#34;&#34;</span> fullword ascii
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>        <span style=color:#8be9fd;font-style:italic>$ver3a</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span><span style=color:#bd93f9>69</span> <span style=color:#bd93f9>68</span> <span style=color:#bd93f9>69</span> <span style=color:#bd93f9>68</span> <span style=color:#bd93f9>69</span> 6B ?? ?? 69<span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>        <span style=color:#8be9fd;font-style:italic>$ver3b</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;iiiiiiiiiiiiiiii&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>        <span style=color:#8be9fd;font-style:italic>$ver4a</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span>2E 2F 2E 2F 2E 2C ?? ?? 2E<span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>        <span style=color:#8be9fd;font-style:italic>$ver4b</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;................&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>        <span style=color:#8be9fd;font-style:italic>$a1</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;%02d/%02d/%02d %02d:%02d:%02d&#34;</span> xor<span style=color:#ff79c6>(</span>0x00-0xff<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>        <span style=color:#8be9fd;font-style:italic>$a2</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Started service %s on %s&#34;</span> xor<span style=color:#ff79c6>(</span>0x00-0xff<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>        <span style=color:#8be9fd;font-style:italic>$a3</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;%s as %s\\%s: %d&#34;</span> xor<span style=color:#ff79c6>(</span>0x00-0xff<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>        <span style=color:#8be9fd;font-style:italic>$b_x64</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span>4C 8B <span style=color:#bd93f9>53</span> <span style=color:#bd93f9>08</span> <span style=color:#bd93f9>45</span> 8B 0A <span style=color:#bd93f9>45</span> 8B 5A <span style=color:#bd93f9>04</span> 4D 8D <span style=color:#bd93f9>52</span> <span style=color:#bd93f9>08</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>85</span> C9 <span style=color:#bd93f9>75</span> <span style=color:#bd93f9>05</span> <span style=color:#bd93f9>45</span> <span style=color:#bd93f9>85</span> DB <span style=color:#bd93f9>74</span> <span style=color:#bd93f9>33</span> <span style=color:#bd93f9>45</span> 3B CB <span style=color:#bd93f9>73</span> E6 <span style=color:#bd93f9>49</span> 8B F9 4C 8B 03<span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        <span style=color:#8be9fd;font-style:italic>$b_x86</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>{</span>8B <span style=color:#bd93f9>46</span> <span style=color:#bd93f9>04</span> 8B <span style=color:#bd93f9>08</span> 8B <span style=color:#bd93f9>50</span> <span style=color:#bd93f9>04</span> <span style=color:#bd93f9>83</span> C0 <span style=color:#bd93f9>08</span> <span style=color:#bd93f9>89</span> <span style=color:#bd93f9>55</span> <span style=color:#bd93f9>08</span> <span style=color:#bd93f9>89</span> <span style=color:#bd93f9>45</span> 0C <span style=color:#bd93f9>85</span> C9 <span style=color:#bd93f9>75</span> <span style=color:#bd93f9>04</span> <span style=color:#bd93f9>85</span> D2 <span style=color:#bd93f9>74</span> <span style=color:#bd93f9>23</span> 3B CA <span style=color:#bd93f9>73</span> E6 8B <span style=color:#bd93f9>06</span> 8D 3C <span style=color:#bd93f9>08</span> <span style=color:#bd93f9>33</span> D2<span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>    condition:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>        all of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$ver3</span>*<span style=color:#ff79c6>)</span> or all of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$ver4</span>*<span style=color:#ff79c6>)</span> or <span style=color:#bd93f9>2</span> of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$a</span>*<span style=color:#ff79c6>)</span> or any of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$b</span>*<span style=color:#ff79c6>)</span> or <span style=color:#bd93f9>5</span> of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$s</span>*<span style=color:#ff79c6>)</span> or <span style=color:#ff79c6>(</span>all of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$pwsh</span>*<span style=color:#ff79c6>)</span> and <span style=color:#bd93f9>2</span> of <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>$s</span>*<span style=color:#ff79c6>))</span> or <span style=color:#ff79c6>(</span><span style=color:#6272a4>#s9 &gt; 6 and 4 of them)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>This rule might look complex, but it&rsquo;s actually quite logical. These strings represent unique characteristics that identify Cobalt Strike Beacon payloads. By understanding how to manipulate conditions, you can create powerful detection rules.</p><h2 id=conclusion>Conclusion</h2><p>YARA rules are powerful tools for cybersecurity professionals. While they may seem complex at first, the basic concepts are straightforward:</p><ul><li>Define patterns to look for (strings)</li><li>Specify when to trigger (conditions)</li><li>Use modifiers for flexibility (nocase, fullword, etc.)</li></ul><p>The examples we&rsquo;ve covered provide a solid foundation for writing your own YARA rules. Start with simple patterns and gradually build complexity as you become more comfortable with the syntax.</p><p>Remember, the key to effective YARA rules is identifying unique, persistent characteristics of the threats you&rsquo;re trying to detect while avoiding false positives.</p><p>Thank you for taking time to read this article, I hope you will find it helpful.</p><p>Keep up the great work!</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#what-are-yara-rules>What are YARA Rules?</a></li><li><a href=#basic-yara-rule-structure>Basic YARA Rule Structure</a><ul><li><a href=#how-it-works>How It Works?</a></li></ul></li><li><a href=#practical-example>Practical Example</a></li><li><a href=#case-sensitivity>Case Sensitivity</a></li><li><a href=#advanced-string-matching>Advanced String Matching</a></li><li><a href=#regular-expressions-and-more>Regular Expressions and More</a></li><li><a href=#key-yara-keywords>Key YARA Keywords</a></li><li><a href=#real-world-examples>Real-World Examples</a><ul><li><a href=#example-1-ransomware-detection>Example 1: Ransomware Detection</a></li><li><a href=#example-2-cobalt-strike-beacon-detection>Example 2: Cobalt Strike Beacon Detection</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&text=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&is_video=false&description=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Understanding%20YARA%20Rules&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&title=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&name=%5bEN%5d%20Understanding%20YARA%20Rules&description=%3cp%3eHi%20everyone%21%20In%20this%20article%2c%20I%26rsquo%3bd%20like%20to%20introduce%20you%20to%20YARA%20rules%2c%20which%20are%20powerful%20detection%20rules%20widely%20used%20in%20cybersecurity%20to%20identify%20malware%20and%20other%20suspicious%20patterns.%3c%2fp%3e%0a%3ch2%20id%3d%22what-are-yara-rules%22%3eWhat%20are%20YARA%20Rules%3f%3c%2fh2%3e%0a%3cp%3eYARA%20rules%20are%20pattern-matching%20rules%20that%20help%20security%20professionals%20detect%20specific%20characteristics%20in%20files%2c%20such%20as%20malware%20signatures%2c%20suspicious%20strings%2c%20or%20other%20indicators%20of%20compromise.%20They%26rsquo%3bre%20essential%20tools%20in%20the%20cybersecurity%20analyst%26rsquo%3bs%20toolkit.%3c%2fp%3e%0a%3ch2%20id%3d%22basic-yara-rule-structure%22%3eBasic%20YARA%20Rule%20Structure%3c%2fh2%3e%0a%3cp%3eThe%20best%20way%20to%20learn%20YARA%20rules%20is%20by%20examining%20examples.%20Let%26rsquo%3bs%20start%20with%20the%20fundamental%20structure%3a%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fyararules%2fyararules%2f&t=%5bEN%5d%20Understanding%20YARA%20Rules" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 ittechnetworkk</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/lightbox.js></script><script src=/js/code-copy.js></script></html>