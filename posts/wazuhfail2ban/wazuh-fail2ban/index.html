<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>[EN] Wazuh Fail2ban Integration | ittechnetworkk</title><link rel=canonical href=https://ittechnetworkk.github.io/posts/wazuhfail2ban/wazuh-fail2ban/><meta name=description content="Hi, I'm Soner, and this is my personal blog where I share insights, guides, and articles on various tech topics, including Networking, Linux, Windows, Virtualization, Firewalls, IoT, and more. I'm constantly learning and exploring new technologies, and this blog is where I document my journey. "><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://ittechnetworkk.github.io/posts/wazuhfail2ban/wazuh-fail2ban/"><meta property="og:site_name" content="ittechnetworkk"><meta property="og:title" content="[EN] Wazuh Fail2ban Integration"><meta property="og:description" content="Hi everyone! In this article I’ll walk you through installing and configuring Fail2Ban and then show you how to integrate it with Wazuh.
Fail2Ban scans log files for repeated authentication failures and automatically bans the offending IP address. Pairing Fail2Ban with Wazuh gives you centralized visibility over those bans and unbans across all of your monitored hosts.
Installation Update your package index and install Fail2Ban:
1sudo apt update 2sudo apt install fail2ban Verify the installation:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-07T17:17:44+01:00"><meta property="article:modified_time" content="2025-11-07T17:17:44+01:00"><meta property="article:tag" content="Wazuh"><meta property="article:tag" content="Soc"><meta property="article:tag" content="Fail2ban"><meta property="article:tag" content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="[EN] Wazuh Fail2ban Integration"><meta name=twitter:description content="Hi everyone! In this article I’ll walk you through installing and configuring Fail2Ban and then show you how to integrate it with Wazuh.
Fail2Ban scans log files for repeated authentication failures and automatically bans the offending IP address. Pairing Fail2Ban with Wazuh gives you centralized visibility over those bans and unbans across all of your monitored hosts.
Installation Update your package index and install Fail2Ban:
1sudo apt update 2sudo apt install fail2ban Verify the installation:"><link rel=stylesheet href=https://ittechnetworkk.github.io/css/styles.bdd621ce0dc4beed42cba9d295fbb7a846b8870c3fda65b870471926d718c2543ebb5d8d248ba9a5554cba6ec2e05b0dc829190fd4e4fef576beaa4c3f244abe.css integrity="sha512-vdYhzg3Evu1Cy6nSlfu3qEa4hww/2mW4cEcZJtcYwlQ+u12NJIuppVVMum7C4FsNyCkZD9Tk/vV2vqpMPyRKvg=="><link rel=stylesheet href=https://ittechnetworkk.github.io/css/custom.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/lightbox.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/tools.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/tools-cards.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/post-cards.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/posts-cards.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ittechnetworkk.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://ittechnetworkk.github.io/posts/wazuhauditd/wazuh-auditd/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://ittechnetworkk.github.io/posts/beelzebubdashboard/beelzebub-dashboard/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&text=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&is_video=false&description=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Wazuh%20Fail2ban%20Integration&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&name=%5bEN%5d%20Wazuh%20Fail2ban%20Integration&description=%3cp%3eHi%20everyone%21%20In%20this%20article%20I%e2%80%99ll%20walk%20you%20through%20installing%20and%20configuring%20Fail2Ban%20and%20then%20show%20you%20how%20to%20integrate%20it%20with%20Wazuh.%3c%2fp%3e%0a%3cp%3eFail2Ban%20scans%20log%20files%20for%20repeated%20authentication%20failures%20and%20automatically%20bans%20the%20offending%20IP%20address.%20Pairing%20Fail2Ban%20with%20Wazuh%20gives%20you%20centralized%20visibility%20over%20those%20bans%20and%20unbans%20across%20all%20of%20your%20monitored%20hosts.%3c%2fp%3e%0a%3ch3%20id%3d%22installation%22%3eInstallation%3c%2fh3%3e%0a%3cp%3eUpdate%20your%20package%20index%20and%20install%20Fail2Ban%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23282a36%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-sh%22%20data-lang%3d%22sh%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e1%3c%2fspan%3e%3cspan%3esudo%20apt%20update%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e2%3c%2fspan%3e%3cspan%3esudo%20apt%20install%20fail2ban%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eVerify%20the%20installation%3a%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&t=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#installation>Installation</a></li><li><a href=#configure-the-jail>Configure the jail</a></li><li><a href=#enable-the-recidive-jail>Enable the recidive jail</a></li><li><a href=#manage-the-fail2ban-service>Manage the Fail2Ban service</a></li><li><a href=#monitor-fail2ban-activity>Monitor Fail2Ban activity</a></li><li><a href=#useful-fail2ban-commands>Useful Fail2Ban commands</a></li><li><a href=#integrate-fail2ban-with-wazuh>Integrate Fail2Ban with Wazuh</a></li><li><a href=#demo>Demo</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">[EN] Wazuh Fail2ban Integration</h1><div class=meta><div class=author-info style=font-size:1.1em;margin-bottom:10px><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><strong>Author:</strong> <span itemprop=name>Soner Sahin</span></span></div><div class=postdate><time datetime="2025-11-07 17:17:44 +0100 CET" itemprop=datePublished>2025-11-07</time></div><div class=article-read-time><i class="far fa-clock"></i>
3 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/soc>SOC</a>
,
<a class=category-link href=/categories/linux>Linux</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/wazuh rel=tag>wazuh</a>
,
<a class=tag-link href=/tags/soc rel=tag>soc</a>
,
<a class=tag-link href=/tags/fail2ban rel=tag>fail2ban</a>
,
<a class=tag-link href=/tags/linux rel=tag>linux</a></div></div></header><div class=content itemprop=articleBody><p>Hi everyone! In this article I’ll walk you through installing and configuring Fail2Ban and then show you how to integrate it with Wazuh.</p><p>Fail2Ban scans log files for repeated authentication failures and automatically bans the offending IP address. Pairing Fail2Ban with Wazuh gives you centralized visibility over those bans and unbans across all of your monitored hosts.</p><h3 id=installation>Installation</h3><p>Update your package index and install Fail2Ban:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo apt update
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>sudo apt install fail2ban
</span></span></code></pre></div><p>Verify the installation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>fail2ban-client --version
</span></span></code></pre></div><h3 id=configure-the-jail>Configure the jail</h3><p>Copy the default configuration so that updates do not overwrite your changes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
</span></span></code></pre></div><p>Open the new file and adjust the SSH jail settings:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo nano /etc/fail2ban/jail.local
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>enabled</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>true</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#8be9fd;font-style:italic>maxretry</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#8be9fd;font-style:italic>findtime</span> <span style=color:#ff79c6>=</span> 10m
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#8be9fd;font-style:italic>bantime</span> <span style=color:#ff79c6>=</span> 4h
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#8be9fd;font-style:italic>port</span>     <span style=color:#ff79c6>=</span> ssh
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#8be9fd;font-style:italic>logpath</span>  <span style=color:#ff79c6>=</span> %<span style=color:#ff79c6>(</span>sshd_log<span style=color:#ff79c6>)</span>s
</span></span></code></pre></div><ul><li><code>maxretry</code> is the number of failed attempts before a ban.</li><li><code>findtime</code> defines the window in which the failures must occur (here, 10 minutes).</li><li><code>bantime</code> is the length of the ban (here, 4 hours).</li></ul><h3 id=enable-the-recidive-jail>Enable the recidive jail</h3><p>The recidive jail is a “super ban” that targets repeat offenders. If an IP address is banned multiple times within the defined window, the recidive jail enforces a longer ban.</p><p>Add the following section to <code>/etc/fail2ban/jail.local</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>[</span>recidive<span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>enabled</span>  <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>true</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#8be9fd;font-style:italic>filter</span>   <span style=color:#ff79c6>=</span> recidive
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#8be9fd;font-style:italic>logpath</span>  <span style=color:#ff79c6>=</span> /var/log/fail2ban.log
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#8be9fd;font-style:italic>bantime</span>  <span style=color:#ff79c6>=</span> 1w
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#8be9fd;font-style:italic>findtime</span> <span style=color:#ff79c6>=</span> 1d
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#8be9fd;font-style:italic>maxretry</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>
</span></span></code></pre></div><h3 id=manage-the-fail2ban-service>Manage the Fail2Ban service</h3><p>Restart and enable the service so it starts automatically after reboots:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo systemctl restart fail2ban
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>sudo systemctl <span style=color:#8be9fd;font-style:italic>enable</span> fail2ban
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>sudo systemctl status fail2ban
</span></span></code></pre></div><h3 id=monitor-fail2ban-activity>Monitor Fail2Ban activity</h3><p>Tail the log to watch bans and unbans in real time:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo tail -f /var/log/fail2ban.log
</span></span></code></pre></div><h3 id=useful-fail2ban-commands>Useful Fail2Ban commands</h3><p>Ban an IP manually for the <code>sshd</code> jail:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo fail2ban-client <span style=color:#8be9fd;font-style:italic>set</span> sshd banip 192.168.122.1
</span></span></code></pre></div><p>Remove a ban:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo fail2ban-client <span style=color:#8be9fd;font-style:italic>set</span> sshd unbanip 192.168.122.1
</span></span></code></pre></div><p>Check the status of the <code>sshd</code> jail:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>fail2ban-client status sshd
</span></span></code></pre></div><h3 id=integrate-fail2ban-with-wazuh>Integrate Fail2Ban with Wazuh</h3><p>These steps assume that the Wazuh agent is already installed on the host and that you have administrative access to the Wazuh manager.</p><p><strong>Agent configuration</strong></p><p>Edit <code>/var/ossec/etc/ossec.conf</code> on the agent so that Fail2Ban logs are forwarded to Wazuh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo nano /var/ossec/etc/ossec.conf
</span></span></code></pre></div><p>Add the following block inside the <code>&lt;ossec_config></code> section:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>  &lt;!-- Fail2Ban logs --&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  &lt;localfile&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    &lt;log_format&gt;syslog&lt;/log_format&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    &lt;location&gt;/var/log/fail2ban.log&lt;/location&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  &lt;/localfile&gt;
</span></span></code></pre></div><p>Restart the agent to apply the change:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo systemctl restart wazuh-agent
</span></span></code></pre></div><p><strong>Wazuh Manager configuration</strong></p><p>Create a custom decoder so Wazuh can parse Fail2Ban events. On the Wazuh manager:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo nano /var/ossec/etc/decoders/fail2ban_decoder.xml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>&lt;decoder <span style=color:#8be9fd;font-style:italic>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;fail2ban&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  &lt;prematch&gt;<span style=color:#ff79c6>[</span><span style=color:#f1fa8c>\d</span>+<span style=color:#ff79c6>]</span>:<span style=color:#f1fa8c>\s</span>*<span style=color:#f1fa8c>\w</span>+<span style=color:#f1fa8c>\s</span>*<span style=color:#ff79c6>[</span><span style=color:#f1fa8c>\w</span>*<span style=color:#ff79c6>]</span>&lt;/prematch&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>&lt;/decoder&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>&lt;decoder <span style=color:#8be9fd;font-style:italic>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;fail2ban&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>  &lt;parent&gt;fail2ban&lt;/parent&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>  &lt;regex&gt;<span style=color:#ff79c6>[(</span><span style=color:#f1fa8c>\d</span>+<span style=color:#ff79c6>)]</span>:<span style=color:#f1fa8c>\s</span>*<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>\w</span>+<span style=color:#ff79c6>)</span><span style=color:#f1fa8c>\s</span>*<span style=color:#ff79c6>[(</span><span style=color:#f1fa8c>\w</span>*<span style=color:#ff79c6>)]</span><span style=color:#f1fa8c>\s</span>*<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>\w</span>*<span style=color:#ff79c6>)</span><span style=color:#f1fa8c>\s</span>*<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>\d</span>+.<span style=color:#f1fa8c>\d</span>+.<span style=color:#f1fa8c>\d</span>+.<span style=color:#f1fa8c>\d</span>+<span style=color:#ff79c6>)</span>$&lt;/regex&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>  &lt;order&gt;process_id,log_level,jail,action,srcip&lt;/order&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>&lt;/decoder&gt;
</span></span></code></pre></div><p>Next, define rules that raise alerts when Fail2Ban bans or unbans an IP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo nano /var/ossec/etc/rules/fail2ban_rules.xml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>&lt;group <span style=color:#8be9fd;font-style:italic>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;fail2ban,&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>  &lt;rule <span style=color:#8be9fd;font-style:italic>id</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;100200&#34;</span> <span style=color:#8be9fd;font-style:italic>level</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  &lt;decoded_as&gt;fail2ban&lt;/decoded_as&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  &lt;action&gt;Ban&lt;/action&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  &lt;description&gt;Fail2Ban has banned an IP address: <span style=color:#ff79c6>$(</span>srcip<span style=color:#ff79c6>)</span> from jail: <span style=color:#ff79c6>$(</span>jail<span style=color:#ff79c6>)</span>&lt;/description&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  &lt;group&gt;authentication_failure,&lt;/group&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  &lt;/rule&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>&lt;/group&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>&lt;group <span style=color:#8be9fd;font-style:italic>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;fail2ban,&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  &lt;rule <span style=color:#8be9fd;font-style:italic>id</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;100201&#34;</span> <span style=color:#8be9fd;font-style:italic>level</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  &lt;decoded_as&gt;fail2ban&lt;/decoded_as&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  &lt;action&gt;Unban&lt;/action&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  &lt;description&gt;Fail2Ban: IP <span style=color:#ff79c6>$(</span>srcip<span style=color:#ff79c6>)</span> unbanned from <span style=color:#ff79c6>$(</span>jail<span style=color:#ff79c6>)</span>&lt;/description&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  &lt;group&gt;authentication_success,&lt;/group&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  &lt;/rule&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>&lt;/group&gt;
</span></span></code></pre></div><p>Reload the manager so the new decoder and rules take effect:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sudo systemctl restart wazuh-manager
</span></span></code></pre></div><h3 id=demo>Demo</h3><p>After three consecutive failed SSH attempts, Fail2Ban bans the source IP and writes the action to <code>/var/log/fail2ban.log</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>root@ubuntu:/home/ubuntu# sudo tail -f /var/log/fail2ban.log
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>2025-11-07 12:37:03,368 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Added logfile: <span style=color:#f1fa8c>&#39;/var/log/fail2ban.log&#39;</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>pos</span> <span style=color:#ff79c6>=</span> 5028, <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> 7da26e49e5d59ab5d52aa865cdadf09d676ae0d1<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>2025-11-07 12:37:03,370 fail2ban.jail           <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Jail <span style=color:#f1fa8c>&#39;sshd&#39;</span> started
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>2025-11-07 12:37:03,372 fail2ban.jail           <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Jail <span style=color:#f1fa8c>&#39;recidive&#39;</span> started
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>2025-11-07 12:37:32,273 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:31
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>2025-11-07 12:37:41,859 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:41
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>2025-11-07 12:37:45,858 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:44
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>2025-11-07 12:37:46,031 fail2ban.actions        <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: NOTICE  <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Ban 192.168.1.148
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>2025-11-07 12:37:46,034 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>recidive<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:46
</span></span></code></pre></div><p>On the Wazuh dashboard you can now visualize the event.</p><p><img src=/images/wazuhfail2ban/1.png alt=Wazuh></p><p><img src=/images/wazuhfail2ban/2.png alt=Wazuh></p><p>When the IP is unbanned, both Fail2Ban and Wazuh record the action:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>root@ubuntu:/home/ubuntu# sudo tail -f /var/log/fail2ban.log
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>2025-11-07 12:37:03,368 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Added logfile: <span style=color:#f1fa8c>&#39;/var/log/fail2ban.log&#39;</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd;font-style:italic>pos</span> <span style=color:#ff79c6>=</span> 5028, <span style=color:#8be9fd;font-style:italic>hash</span> <span style=color:#ff79c6>=</span> 7da26e49e5d59ab5d52aa865cdadf09d676ae0d1<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>2025-11-07 12:37:03,370 fail2ban.jail           <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Jail <span style=color:#f1fa8c>&#39;sshd&#39;</span> started
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>2025-11-07 12:37:03,372 fail2ban.jail           <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    Jail <span style=color:#f1fa8c>&#39;recidive&#39;</span> started
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>2025-11-07 12:37:32,273 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:31
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>2025-11-07 12:37:41,859 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:41
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>2025-11-07 12:37:45,858 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:44
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>2025-11-07 12:37:46,031 fail2ban.actions        <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: NOTICE  <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Ban 192.168.1.148
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>2025-11-07 12:37:46,034 fail2ban.filter         <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: INFO    <span style=color:#ff79c6>[</span>recidive<span style=color:#ff79c6>]</span> Found 192.168.1.148 - 2025-11-07 12:37:46
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>2025-11-07 12:42:25,432 fail2ban.actions        <span style=color:#ff79c6>[</span>19120<span style=color:#ff79c6>]</span>: NOTICE  <span style=color:#ff79c6>[</span>sshd<span style=color:#ff79c6>]</span> Unban 192.168.1.148
</span></span></code></pre></div><p><img src=/images/wazuhfail2ban/3.png alt=Wazuh></p><p><img src=/images/wazuhfail2ban/4.png alt=Wazuh></p><p>That&rsquo;s all.</p><p>Thank you for taking time to read this article, I hope you&rsquo;ll find this article useful.</p><p>Keep up the good work!</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><ul><li><a href=#installation>Installation</a></li><li><a href=#configure-the-jail>Configure the jail</a></li><li><a href=#enable-the-recidive-jail>Enable the recidive jail</a></li><li><a href=#manage-the-fail2ban-service>Manage the Fail2Ban service</a></li><li><a href=#monitor-fail2ban-activity>Monitor Fail2Ban activity</a></li><li><a href=#useful-fail2ban-commands>Useful Fail2Ban commands</a></li><li><a href=#integrate-fail2ban-with-wazuh>Integrate Fail2Ban with Wazuh</a></li><li><a href=#demo>Demo</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&text=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&is_video=false&description=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Wazuh%20Fail2ban%20Integration&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&title=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&name=%5bEN%5d%20Wazuh%20Fail2ban%20Integration&description=%3cp%3eHi%20everyone%21%20In%20this%20article%20I%e2%80%99ll%20walk%20you%20through%20installing%20and%20configuring%20Fail2Ban%20and%20then%20show%20you%20how%20to%20integrate%20it%20with%20Wazuh.%3c%2fp%3e%0a%3cp%3eFail2Ban%20scans%20log%20files%20for%20repeated%20authentication%20failures%20and%20automatically%20bans%20the%20offending%20IP%20address.%20Pairing%20Fail2Ban%20with%20Wazuh%20gives%20you%20centralized%20visibility%20over%20those%20bans%20and%20unbans%20across%20all%20of%20your%20monitored%20hosts.%3c%2fp%3e%0a%3ch3%20id%3d%22installation%22%3eInstallation%3c%2fh3%3e%0a%3cp%3eUpdate%20your%20package%20index%20and%20install%20Fail2Ban%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23282a36%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-sh%22%20data-lang%3d%22sh%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e1%3c%2fspan%3e%3cspan%3esudo%20apt%20update%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e2%3c%2fspan%3e%3cspan%3esudo%20apt%20install%20fail2ban%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eVerify%20the%20installation%3a%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fwazuhfail2ban%2fwazuh-fail2ban%2f&t=%5bEN%5d%20Wazuh%20Fail2ban%20Integration" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 ittechnetworkk</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/tools/>Tools</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/lightbox.js></script><script src=/js/code-copy.js></script></html>